<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-react-helmet="true">Session-based Recommenders | Recohut</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.recohut.com/docs/concept-basics/session-based-recommenders"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Session-based Recommenders | Recohut"><meta data-react-helmet="true" name="description" content="Recommender systems help users find relevant items of interest, for example on e-commerce or media streaming sites. Most academic research is concerned with approaches that personalize the recommendations according to long-term user profiles. In many real-world applications, however, such long-term profiles often do not exist and recommendations, therefore, have to be made solely based on the observed behavior of a user during an ongoing session."><meta data-react-helmet="true" property="og:description" content="Recommender systems help users find relevant items of interest, for example on e-commerce or media streaming sites. Most academic research is concerned with approaches that personalize the recommendations according to long-term user profiles. In many real-world applications, however, such long-term profiles often do not exist and recommendations, therefore, have to be made solely based on the observed behavior of a user during an ongoing session."><link data-react-helmet="true" rel="icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.recohut.com/docs/concept-basics/session-based-recommenders"><link data-react-helmet="true" rel="alternate" href="https://docs.recohut.com/docs/concept-basics/session-based-recommenders" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.recohut.com/docs/concept-basics/session-based-recommenders" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.87c99533.css">
<link rel="preload" href="/assets/js/runtime~main.3cb90aa6.js" as="script">
<link rel="preload" href="/assets/js/main.cf2de00b.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Recohut Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Recohut Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Recohut</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/recohut/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/docs/concept-basics/">Concept - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concept - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/challenges">Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/collaborative-filtering">Collaborative Filtering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/evaluation">Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/implicit-feedback">User Feedback</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/processes">Processes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/concept-basics/session-based-recommenders">Session-based Recommenders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/tasks">Tasks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concept-basics/types-of-recommender-systems">Types of Recommender Systems</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/concept-extras/">Concept - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concept - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/models/">Models</a><button aria-label="Toggle the collapsible sidebar category &#x27;Models&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/tutorials/amazon-personalize">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/snippets/python-snippets">Snippets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/tools/">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/datasets">Datasets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/projects">Projects</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Session-based Recommenders</h1></header><p>Recommender systems help users find relevant items of interest, for example on e-commerce or media streaming sites. Most academic research is concerned with approaches that personalize the recommendations according to long-term user profiles. In many real-world applications, however, such long-term profiles often do not exist and recommendations, therefore, have to be made solely based on the observed behavior of a user during an ongoing session.</p><p><img alt="Session-based recommendations" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-3806775b9d8e607609b0eaac381c954c.png"></p><p>Session-based recommendations</p><p>Session-based recommendation is an important task for domains such as e-commerce, news, streaming video and music services, where users might be untraceable, their histories can be short, and users can have rapidly changing tastes. Providing recommendations based purely on the interactions that happen in the current session.</p><p>Given the high practical relevance of the problem, and increased interest in this problem can be observed in recent years, leading to a number of proposals for session-based recommendation algorithms that typically aim to predict the user’s immediate next actions. Recommendation techniques that rely solely on the user’s actions in an ongoing session and which adapt their recommendations to the user’s actions are called <strong><em>session-based recommendation approaches</em></strong> <!-- -->[Quadrana et al. 2018]<!-- -->. Amazon’s “Customers who bought . . . also bought” recommendations can be considered an extreme case of such a session-based approach. In this case, the recommendations are seemingly only dependent on the item that is currently viewed by the user (and the purchasing patterns of the community).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>Session-based recommendation tasks are performed based on the user&#x27;s anonymous historical behavior sequence and implicit feedback data, such as clicks, browsing, purchasing, etc., rather than rating or comment data. The primary aim is to predict the next behavior based on a sequence of the historical sequence of the session. Session-based recommendation aims to predict which item a user will click next, solely based on the user’s current sequential session data without access to the long-term preference profile.</p><p>The input to these systems are time-ordered logs of recorded user interactions, where the interactions are grouped into sessions. Such a session could, for example, correspond to a listening session on a music service, or a shopping session on an e-commerce site. One particularity of such approaches is that users are anonymous, which is a common problem on websites that deal with first-time users or users that are not logged in. The prediction task in this setting is to predict the next user action, given only the interactions of the ongoing session. Today, session-based recommendation is a highly active research area due to its practical relevance.</p><p>Markov chains is a classic case, which assumes that the next action is based on the previous ones. Many sequential recommendation methods based on the Markov chain (MC) model predict the next item based on the previous one through computing transition probabilities between two consecutive items. FPMC models the sequence behavior between every two adjacent clicks and provides a more accurate prediction for each sequence by factoring the user&#x27;s personalized probability transfer matrix. The main problem with Markov methods, however, is that they assume too strongly the independence of more than two consecutive actions, so a great number of important sequential information cannot be well exploited for sessions with more than two actions.</p><p>The proposal of recurrent neural network (RNN) has obtained promising results in the session-based recommendation system, which has been proved to be effective in capturing users&#x27; preference from a sequence of historical actions. GRU4REC achieved significant progress over conventional methods. Because of their excellent performance, many followers began to try this method. Tan et al. further propose two techniques to improve the performance of session-based recommendation. Although these methods have improved the performance of session-based recommendation, they are all restricted by the constraints of RNNs that both the offline training and the online prediction process are time-consuming, due to its recursive nature which is hard to be parallelized. RNN-based methods hold that there is a strict sequential relationship between two adjacent items in a session, which restricts the extraction of the characteristics of session dynamic changes.</p><p>After the successful application of Transformer in Natural Language Processing (NLP), many attention-based models have been designed, which has been shown that comparable performance with RNNs in many sequence processing tasks. Li et al. proposed a hybrid RNN-based encoder with an attention layer, which is called neural attentive recommendation machine (NARM), employs the attention mechanism on RNN to capture users’ features of sequential behavior and main purposes. NARM is designed to capture the user’s sequential pattern and main purpose simultaneously by employing a global and local RNN. Then, a short-term attention priority model (STAMP) using simple MLP networks and an attentive net, is proposed to efficiently capture both users’ general interest and current interest. However, it only takes the future mean value of all items in the session as the context, without taking the dynamic variations and local dependencies of the sequence into account. A position-aware context attention (PACA) model for session-based recommendation has was proposed in 2019, which takes into account both the context information and the position information of items. However, this method only trains an additional implicit vector for each item and has little performance improvement for session-based recommendation tasks.</p><p>Xu et al. proposed Graph Contextualized Self Attention Network for Session-based Recommendation, which is a combination of GNN and attention mechanisms, and further improves the accuracy of the recommendation. </p><p><img alt="/img/content-concepts-raw-session-based-recommenders-untitled-1.png" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-1-26801f978540cd6fe829e1762d428729.png"></p><p>A session is a chunk of interactions that take place within a given time frame. It may span a single day, or several days, weeks, or even months. A session usually has a time-limited goal, such as finding a restaurant for dinner tonight, listening to music of a certain style or mood, or looking for a location for one’s next holiday.</p><p><img alt="/img/content-concepts-raw-session-based-recommenders-untitled-2.png" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-2-205643e887b3c1046740589270bf41a2.png"></p><p>Session data has many important characteristics:</p><ul><li>Session clicks and navigation are sequential by nature. The order of clicks as well as the navigational path may contain information about user intent.</li><li>Viewed items often have metadata such as names, categories, and descriptions, which provides information about the user’s tastes and what they are looking for.</li><li>Sessions are limited in time and scope. A session has a specific goal and generally ends once that goal is accomplished: rent a hotel for a business trip, find a restaurant for a romantic date, and so on. This means that the session has intrinsic informational power related to a specific item (such as the hotel or restaurant that’s eventually booked).</li></ul><p><img alt="/img/content-concepts-raw-session-based-recommenders-untitled-3.png" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-3-ae96d367af14d085e3e13f72a2b50c97.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="what-srss-are-important">What SRS&#x27;s are important?<a class="hash-link" href="#what-srss-are-important" title="Direct link to heading">​</a></h3><ul><li>Caveats of user identification technologies<ul><li>Cookies and browser fingerprinting can not always recognize users correctly, especially across different devices and platforms</li><li>Opt-out users are not tracked across sessions</li><li>Privacy concerns for opt-in users</li></ul></li><li>Infrequent user visits, cookie expiration - Users visiting a site infrequently can not be recognized over long time</li><li>Changing user intent across sessions - On many domains, users have session-based traits (short video sites, marketplaces, classified sites, etc.)</li><li>Earlier solutions for handling sessions was only based on last user click and ignored user interactions in the session</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tasks">Tasks<a class="hash-link" href="#tasks" title="Direct link to heading">​</a></h2><ol><li>Predict the next item (evaluated by ranking metrics like MRR)</li><li>Predict all subsequent items in the current session (evaluated by metrics like precision, F1)</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">​</a></h2><p><img alt="[https://arxiv.org/pdf/2010.12540.pdf](https://arxiv.org/pdf/2010.12540.pdf)" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-4-3061abc4ed2a476171edf6b0dfa03e40.png"></p><p><a href="https://arxiv.org/pdf/2010.12540.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/2010.12540.pdf</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="simple-association-rules-ar">Simple Association Rules (ar)<a class="hash-link" href="#simple-association-rules-ar" title="Direct link to heading">​</a></h3><p>Simple Association Rules (ar) are a simplified version of the association rule mining technique <!-- -->[Agrawal et al. 1993]<!-- --> with a maximum rule size of two. The method is designed to capture the frequency of two co-occurring events, e.g., “Customers who bought . . . also bought”. Algorithmically, the rules and their corresponding importance are “learned” by counting how often the items i and j occurred together in a session of any user.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="markov-chains-mc">Markov Chains (mc)<a class="hash-link" href="#markov-chains-mc" title="Direct link to heading">​</a></h3><p>The mc baseline can be seen as a variant of ar with a focus on sequences in the data. Here, the rules are extracted from a first-order Markov Chain, which describes the transition probability between two subsequent events in a session. It can simply be a count of how often users viewed item q immediately after viewing item p.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sequential-rules-sr">Sequential Rules (sr)<a class="hash-link" href="#sequential-rules-sr" title="Direct link to heading">​</a></h3><p>Sequential Rule is a variation of mc or ar. It takes the order of actions into account, but in a less restrictive manner. In contrast to the mc method, we create a rule when an item q appeared after an item p in a session even when other events happened between p and q. When assigning weights to the rules, we consider the number of elements appearing between p and q in the session. Specifically, we use the weight function wsr(x) = 1/(x), where x corresponds to the number of steps between the two items.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="item-based-knn-iknn">Item-based kNN (iknn)<a class="hash-link" href="#item-based-knn-iknn" title="Direct link to heading">​</a></h3><p>The iknn method only considers the last element in a given session and then returns those items as recommendations that are most similar to it in terms of their co-occurrence in other sessions. Technically, each item is encoded as a binary vector, where each element corresponds to a session and is set to “1” in case the item appeared in the session. The similarity of two items can then be determined, e.g., using the cosine similarity measure, and the number of neighbors k is implicitly defined by the desired recommendation list length.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="session-based-knn-sknn">Session-based kNN (sknn)<a class="hash-link" href="#session-based-knn-sknn" title="Direct link to heading">​</a></h3><p>Instead of considering only the last event in the current session, the sknn method compares the entire current session with the past sessions in the training data to determine the items to be recommended. Technically, given a session s, we first determine the k most similar past sessions (neighbors) Ns by applying a suitable session similarity measure, e.g., the Jaccard index or cosine similarity on binary vectors over the item space.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="vector-multiplication-session-based-knn-v-sknn">Vector Multiplication Session-Based kNN (v-sknn)<a class="hash-link" href="#vector-multiplication-session-based-knn-v-sknn" title="Direct link to heading">​</a></h3><p>iknn and sknn do not consider the order of the elements in a session when using the Jaccard index or cosine similarity as a distance measure. The idea of this variant is to put more emphasis on the more recent events of a session when computing the similarities. Instead of encoding a session as a binary vector as described above, we use real-valued vectors to encode the current session. Only the very last element of the session obtains a value of “1”; the weights of the other elements are determined using a linear decay function that depends on the position of the element within the session, where elements appearing earlier in the session obtain a lower weight. As a result, when using the dot product as a similarity function between the current weight-encoded session and a binary-encoded past session, more emphasis is given to elements that appear later in the sessions.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sequential-session-based-knn-s-sknn">Sequential Session-based kNN (s-sknn)<a class="hash-link" href="#sequential-session-based-knn-s-sknn" title="Direct link to heading">​</a></h3><p>This variant also puts more weight on elements that appear later in the session. This time, however, we achieve the effect with a different scoring function. The indicator function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mn>1</mn><mi>n</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1_n(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span> is complemented with a weighting function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_n(i,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>, which takes the order of the events in the current session s into account. The weight <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_n(i,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span> increases when the more recent items of the current session s also appeared in a neighboring session n.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sequential-filter-session-based-knn-sf-sknn">Sequential Filter Session-based kNN (sf-sknn)<a class="hash-link" href="#sequential-filter-session-based-knn-sf-sknn" title="Direct link to heading">​</a></h3><p>This method also uses a modified scoring function but in a more restrictive way. The basic idea is that given the last event (and related item <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi mathvariant="normal">∣</mi><mi>s</mi><mi mathvariant="normal">∣</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{|s|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight">s</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em"><span></span></span></span></span></span></span></span></span></span></span>) of the current session s, we only consider items for the recommendation that appeared directly after <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi mathvariant="normal">∣</mi><mi>s</mi><mi mathvariant="normal">∣</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{|s|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight">s</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em"><span></span></span></span></span></span></span></span></span></span></span> in the training data at least once.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="gru4rec">GRU4REC<a class="hash-link" href="#gru4rec" title="Direct link to heading">​</a></h3><p>gru4rec models user sessions with the help of an RNN with Gated Recurrent Units <!-- -->[Cho et al. 2014]<!-- --> in order to predict the probability of the subsequent events (e.g., item clicks) given a session beginning. The input of the network is formed by a single item, which is one-hot encoded in a vector representing the entire item space, and the output is a vector of similar shape that should give a ranking distribution for the subsequent item.</p><p><img alt="session-parallel mini-batch scheme for training" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-5-bd6a9c5ac985f1f8bbaae8bbe33294c7.png"></p><p>session-parallel mini-batch scheme for training</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="factorized-personalized-markov-chains-fpmc">Factorized Personalized Markov Chains (fpmc)<a class="hash-link" href="#factorized-personalized-markov-chains-fpmc" title="Direct link to heading">​</a></h3><p>The fpmc method was designed for the specific problem of next-basket recommendation. The problem consists of predicting the contents of the next basket of a user, given his or her history of past shopping baskets. By limiting the basket size to one item and by considering the current session as the history of baskets, the method can be directly applied for session-based recommendation problems. Technically, fpmc combines mc and traditional user-item matrix factorization in a three-dimensional tensor factorization approach. The third dimension captures the transition probabilities from one item to another.</p><p><img alt="/img/content-concepts-raw-session-based-recommenders-untitled-6.png" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-6-e9f396335e8ea97a2bde9a7d1fb83ee5.png"></p><p>Internally, a special form of the Canonical Tensor Decomposition is used to factor the cube into latent matrices, which can then be used to predict a ranking. In our problem setting, where we have no long-term user histories, each session in the training data corresponds to a user. Once the model is trained, each new session therefore represents a user cold-start situation. To apply the model to our setting, we estimate the session latent vectors as the average of the latent factors of the individual items in the session.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="use-cases"><strong>Use Cases</strong><a class="hash-link" href="#use-cases" title="Direct link to heading">​</a></h2><p>This problem is well-aligned with emerging real-world use cases, in which modeling short-term preferences is highly desirable. Consider the following examples in music, rental, and product spaces.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="music-recommendations"><strong>Music recommendations</strong><a class="hash-link" href="#music-recommendations" title="Direct link to heading">​</a></h3><p>Recommending additional content that a user might like while they browse through a list of songs can change a user’s experience on a content platform.</p><p>The user’s listening queue follows a sequence. For each song the user has listened to in the past, we would want to identify the songs listened to directly before and after it, and use them to teach the machine learning model that those songs somehow belong to the same context. This allows us to find songs that are similar, and provide better recommendations.</p><p><img src="https://session-based-recommenders.fastforwardlabs.com/figures/FF19_Artboard_6rev.png" alt="https://session-based-recommenders.fastforwardlabs.com/figures/FF19_Artboard_6rev.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="rental-recommendations"><strong>Rental recommendations</strong><a class="hash-link" href="#rental-recommendations" title="Direct link to heading">​</a></h3><p>Another powerful and useful application of session-based recommendation systems occurs in any type of online marketplace. For instance, imagine a website that contains millions of diverse rental listings, and a guest exploring them in search of a place to rent for a vacation. The machine learning model in such a situation should be able to leverage what the guest views during an ongoing search, and learn from these search sessions the similarities between the listings. The similarities learned by the model could potentially encode listing features-like location, price, amenities, design taste, and architecture.</p><p><img src="https://session-based-recommenders.fastforwardlabs.com/figures/FF19_Artboard_7rev.png" alt="https://session-based-recommenders.fastforwardlabs.com/figures/FF19_Artboard_7rev.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="product-recommendations"><strong>Product recommendations</strong><a class="hash-link" href="#product-recommendations" title="Direct link to heading">​</a></h3><p>Leveraging emails in the forms of promotions and purchase receipts to recommend the next item to be purchased has also proven to be a strong purchase intent signal. Again, the idea here is to learn a representation of products from historical sequences of product purchases, under the assumption that products with similar contexts (that is, surrounding purchases) can help recommend more meaningful and diverse suggestions for the next product a user might want to purchase.</p><p><img src="https://session-based-recommenders.fastforwardlabs.com/figures/FF19_Artboard_8rev.png" alt="https://session-based-recommenders.fastforwardlabs.com/figures/FF19_Artboard_8rev.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="preprocessing">Preprocessing<a class="hash-link" href="#preprocessing" title="Direct link to heading">​</a></h3><ol><li>Filtering<ol><li>Remove items with less than 5 interactions</li><li>Remove session than contain only 1 event</li></ol></li><li>Partition the log into sessions<ol><li>Apply 30-minute user inactivity threshold</li></ol></li><li>Split the data<ol><li>Since most datasets consist of time-ordered events, usual cross-validation procedures with the randomized allocation of events across data splits cannot be applied.</li><li>Last day sessions as the test set</li></ol></li><li>Transformation<ol><li>Replace multiple consecutive clicks on the same item by a single click on that item</li><li>For playlist music datasets, we can randomly generate timestamps if not available</li></ol></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="evaluation-metrics">Evaluation metrics<a class="hash-link" href="#evaluation-metrics" title="Direct link to heading">​</a></h3><ol><li>Immediate next-item as the target item<ol><li>Hit Rate</li><li>Mean Reciprocal Rank</li></ol></li><li>All the remaining items of the current session as the target items<ol><li>Precision</li><li>Recall</li><li>Mean Average Precision</li></ol></li><li>Coverage and Popularity bias</li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="quality-factors">Quality factors<a class="hash-link" href="#quality-factors" title="Direct link to heading">​</a></h3><ul><li>Coverage: how many different items ever appear in the top-k recommendations. This measure represents a form of catalog coverage, which is sometimes referred to as aggregate diversity.</li><li>Popularity bias: High accuracy values can, depending on the measurement method, correlate with the tendency of an algorithm to recommend mostly popular items <!-- -->[Jannach et al. 2015b]<!-- -->. To assess the popularity tendencies of the tested algorithms, we report the average popularity score for the elements of the top-k recommendations of each algorithm. This average score is the mean of the individual popularity scores of each recommended item. We compute these scores based on the training set by counting how often each item appears in one of the training sessions and by then applying min-max normalization to obtain a score between 0 and 1.</li><li>Cold start: Some methods might only be effective when a significant amount of training data is available. We, therefore, report the results of measurements where we artificially removed parts of the (older) training data to simulate such situations.</li><li>Scalability: Training modern machine learning methods can be computationally challenging, and obtaining good results may furthermore require extensive parameter tuning. We, therefore, report the times that the algorithms needed to train the models and to make predictions at runtime. In addition, we report the memory requirements of the algorithms.</li></ul><aside>💡 By using different quality factors, we emphasize that different recommendation strategies can lead to quite different recommendations, even if they are similar in terms of prediction accuracy. Such multi-metric evaluation approaches should also help practitioners to better understand the potential side effects of the recommenders, e.g., reduced average sales diversity and additionally increased sales of top-sellers. It remains however difficult to aggregate the individual performance factors into one single score, as the relative importance of the factors can depend not only on the application domain but also on the specific business model of the provider</aside><h2 class="anchor anchorWithStickyNavbar_y2LR" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ol><li><a href="https://arxiv.org/pdf/1803.09587.pdf" target="_blank" rel="noopener noreferrer">M. Ludewig and D. Jannach, 2018. &quot;<em>Evaluation of Session-based Recommendation Algorithms</em>&quot;, arXiv</a>. <a href="https://github.com/rn5l/session-rec" target="_blank" rel="noopener noreferrer">[code]</a>. </li><li><a href="https://arxiv.org/abs/1802.08452" target="_blank" rel="noopener noreferrer">M. Quadrana, P. Cremonesi, and D. Jannach, 2018. &quot;<em>Sequence-Aware Recommender Systems</em>&quot;, arXiv</a>. <a href="https://github.com/mquad/sars_tutorial" target="_blank" rel="noopener noreferrer">[code]</a>.</li><li><a href="https://recsys.acm.org/wp-content/uploads/2019/09/recsys-19-material-predictability.pdf" target="_blank" rel="noopener noreferrer">Predictability Limitsin Session-based Next Item Recommendation</a></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="appendix">Appendix<a class="hash-link" href="#appendix" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="session-based-vs-sequence-aware-recommenders">Session-based vs Sequence-aware Recommenders<a class="hash-link" href="#session-based-vs-sequence-aware-recommenders" title="Direct link to heading">​</a></h3><p><img alt="/img/content-concepts-raw-session-based-recommenders-untitled-7.png" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-7-6bd4da9ef7ee16914f5973ca1428d699.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="short-summary-of-srs-methods">Short summary of SRS methods<a class="hash-link" href="#short-summary-of-srs-methods" title="Direct link to heading">​</a></h3><p>SRSs aim at predicting the next item of each session. Without any user-dependent information, the only information that SRSs can utilize is the chronologically-ordered item sequence in each session which implies the short-term interest of user. Accordingly, some existing methods focus on how to effectively modeling the information in each single session. For example, GRU4Rec uses GRU which takes the embeddings of items in a session as input, to model the sequential patterns in the session. NARM summarizes the hidden states of GRU using an attention module, to model the user’s main purpose and sequential patterns in the session. STAMP incorporates each item information in a session according to its similarity to the last item based on an attention mechanism, to focus on the most recent interest. SASRec uses a self-attention network to capture the user’s preference within a sequence. SR-GNN, which is the first attempt to express the sessions in directed graphs, captures the complex transitions of items in a session via graph neural networks. FGNN introduces an attentional layer and a new readout function in graph neural networks to consider the latent order rather than the chronological item order in a session. RepeatNet first predicts whether the next item will be a repeat consumption or a new item, and then predicts the next item for each case. GRec leverages future data as well when learning the preferences for target items in a session for richer information in dilated convolutional neural networks. However, these methods cannot consider the relationships between sessions, as they use only the information within a single session. To overcome this limitation, some recent methods define the relationships between sessions using the item co-occurrence between them. CSRM incorporates information of the latest few sessions according to their similarity to the current session. CoSAN extends CSRM to find out the similar sessions for each item, not for each session. GCE-GNN, which shows the state-of-the-art recommendation performance, constructs a global graph that models pairwise item-transitions over sessions.</p><p><img alt="/img/content-concepts-raw-session-based-recommenders-untitled-8.png" src="/assets/images/content-concepts-raw-session-based-recommenders-untitled-8-ebd1ecfa194fff376eb52a3779988e32.png"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/sparsh-ai/ml-utils/docs/concept-basics/session-based-recommenders.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/concept-basics/processes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Processes</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/concept-basics/tasks"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tasks</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#what-srss-are-important" class="table-of-contents__link toc-highlight">What SRS&#39;s are important?</a></li></ul></li><li><a href="#tasks" class="table-of-contents__link toc-highlight">Tasks</a></li><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a><ul><li><a href="#simple-association-rules-ar" class="table-of-contents__link toc-highlight">Simple Association Rules (ar)</a></li><li><a href="#markov-chains-mc" class="table-of-contents__link toc-highlight">Markov Chains (mc)</a></li><li><a href="#sequential-rules-sr" class="table-of-contents__link toc-highlight">Sequential Rules (sr)</a></li><li><a href="#item-based-knn-iknn" class="table-of-contents__link toc-highlight">Item-based kNN (iknn)</a></li><li><a href="#session-based-knn-sknn" class="table-of-contents__link toc-highlight">Session-based kNN (sknn)</a></li><li><a href="#vector-multiplication-session-based-knn-v-sknn" class="table-of-contents__link toc-highlight">Vector Multiplication Session-Based kNN (v-sknn)</a></li><li><a href="#sequential-session-based-knn-s-sknn" class="table-of-contents__link toc-highlight">Sequential Session-based kNN (s-sknn)</a></li><li><a href="#sequential-filter-session-based-knn-sf-sknn" class="table-of-contents__link toc-highlight">Sequential Filter Session-based kNN (sf-sknn)</a></li><li><a href="#gru4rec" class="table-of-contents__link toc-highlight">GRU4REC</a></li><li><a href="#factorized-personalized-markov-chains-fpmc" class="table-of-contents__link toc-highlight">Factorized Personalized Markov Chains (fpmc)</a></li></ul></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight"><strong>Use Cases</strong></a><ul><li><a href="#music-recommendations" class="table-of-contents__link toc-highlight"><strong>Music recommendations</strong></a></li><li><a href="#rental-recommendations" class="table-of-contents__link toc-highlight"><strong>Rental recommendations</strong></a></li><li><a href="#product-recommendations" class="table-of-contents__link toc-highlight"><strong>Product recommendations</strong></a></li><li><a href="#preprocessing" class="table-of-contents__link toc-highlight">Preprocessing</a></li><li><a href="#evaluation-metrics" class="table-of-contents__link toc-highlight">Evaluation metrics</a></li><li><a href="#quality-factors" class="table-of-contents__link toc-highlight">Quality factors</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#session-based-vs-sequence-aware-recommenders" class="table-of-contents__link toc-highlight">Session-based vs Sequence-aware Recommenders</a></li><li><a href="#short-summary-of-srs-methods" class="table-of-contents__link toc-highlight">Short summary of SRS methods</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/concept-basics">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/projects">Projects</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/recohut/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://nb.recohut.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Jupyter Notebooks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://step.recohut.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Interactive Stories<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Recohut Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3cb90aa6.js"></script>
<script src="/assets/js/main.cf2de00b.js"></script>
</body>
</html>