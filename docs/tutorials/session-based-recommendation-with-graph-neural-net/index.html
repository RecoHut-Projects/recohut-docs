<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-react-helmet="true">Session-based Recommendation with Graph Neural Networks | Recohut</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.recohut.com/docs/tutorials/session-based-recommendation-with-graph-neural-net"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Session-based Recommendation with Graph Neural Networks | Recohut"><meta data-react-helmet="true" name="description" content="Session-based recommendation tasks are performed based on the user&#x27;s anonymous historical behavior sequence and implicit feedback data, such as clicks, browsing, purchasing, etc., rather than rating or comment data. The primary aim is to predict the next behavior based on a sequence of the historical sequence of the session. Session-based recommendation aims to predict which item a user will click next, solely based on the user’s current sequential session data without access to the long-term preference profile."><meta data-react-helmet="true" property="og:description" content="Session-based recommendation tasks are performed based on the user&#x27;s anonymous historical behavior sequence and implicit feedback data, such as clicks, browsing, purchasing, etc., rather than rating or comment data. The primary aim is to predict the next behavior based on a sequence of the historical sequence of the session. Session-based recommendation aims to predict which item a user will click next, solely based on the user’s current sequential session data without access to the long-term preference profile."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.recohut.com/docs/tutorials/session-based-recommendation-with-graph-neural-net"><link data-react-helmet="true" rel="alternate" href="https://docs.recohut.com/docs/tutorials/session-based-recommendation-with-graph-neural-net" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.recohut.com/docs/tutorials/session-based-recommendation-with-graph-neural-net" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.52d28afd.css">
<link rel="preload" href="/assets/js/runtime~main.cb8160eb.js" as="script">
<link rel="preload" href="/assets/js/main.fedda83c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Recohut Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Recohut Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Recohut</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/recohut/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/concept-basics/">Concept - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concept - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/concept-extras/">Concept - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concept - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/models/">Models</a><button aria-label="Toggle the collapsible sidebar category &#x27;Models&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/data-science-bookcamp">Data Science Bookcamp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/matching-and-ranking-models-in-tensorflow">Matching and Ranking models in Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb">Real-time event capturing with Kafka and MongoDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorials/session-based-recommendation-with-graph-neural-net">Session-based Recommendation with Graph Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tensorflow-2-reinforcement-learning-cookbook">TensorFlow 2 Reinforcement Learning Cookbook</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/tools/">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/datasets">Datasets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/projects">Projects</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Session-based Recommendation with Graph Neural Networks</h1></header><p>Session-based recommendation tasks are performed based on the user&#x27;s anonymous historical behavior sequence and implicit feedback data, such as clicks, browsing, purchasing, etc., rather than rating or comment data. The primary aim is to predict the next behavior based on a sequence of the historical sequence of the session. Session-based recommendation aims to predict which item a user will click next, solely based on the user’s current sequential session data without access to the long-term preference profile.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Session-based recommenders are gaining popularity due to user privacy concerns.</p></div></div><p>The input to these systems are time-ordered logs of recorded user interactions, where the interactions are grouped into sessions. Such a session could, for example, correspond to a listening session on a music service, or a shopping session on an e-commerce site. One particularity of such approaches is that users are anonymous, which is a common problem on websites that deal with first-time users or users that are not logged in. The prediction task in this setting is to predict the next user action, given only the interactions of the ongoing session. Today, session-based recommendation is a highly active research area due to its practical relevance.</p><p><img alt="/img/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled.png" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-26801f978540cd6fe829e1762d428729.png"></p><p>Some of the major reason for the effectiveness and the growing popularity of session-based recommenders are: 1) Cookies and browser fingerprinting can not always recognize users correctly, especially across different devices and platforms, 2) Opt-out users are not tracked across sessions, 3) Privacy concerns for opt-in users, 4) Infrequent user visits, cookie expiration - Users visiting a site infrequently can not be recognized over long time, 5) Changing user intent across sessions - On many domains, users have session-based traits (short video sites, marketplaces, classified sites, etc.), and 6) Earlier solutions for handling sessions was only based on last user click and ignored user interactions in the session.</p><p>Session-based recommendation is an important task for domains such as e-commerce, news, streaming video and music services, where users might be untraceable, their histories can be short, and users can have rapidly changing tastes. Providing recommendations based purely on the interactions that happen in the current session.</p><p>But the problem of session-based recommendation aims to predict user actions based on anonymous sessions. Previous methods model a session as a sequence and estimate user representations besides item representations to make recommendations. Though achieved promising results, they are insufficient to obtain accurate user vectors in sessions and neglect complex transitions of items.</p><p>Session-based recommendations are challenging due to limited user-item interactions. Typical sequential models are not able to capture complex patterns from all previous interactions.</p><p>GNNs offer an intuitive approach to session-based recommendation since each session can be mapped into a graph’s chain. Each node of the graph represents an item, and each edge represents the interactions. The natural compatibility between data modeled in such a manner and GNNs allow this method to perform well.</p><p>Here is the general framework of session-based recommendations using GNNs:</p><p><img alt="/img/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-1.png" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-1-ae96d367af14d085e3e13f72a2b50c97.png"></p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>fun fact</h5></div><div class="admonition-content"><p>Representation of session with Graph neural networks was first introduced in the <strong>SR-GNN</strong> paper. In this method, session sequences are modeled as graph-structured data. Based on the session graph, GNN can capture complex transitions of items, which are difficult to be revealed by previous conventional sequential methods. Each session is then represented as the composition of the global preference and the current interest of that session using an attention network.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="datasets">Datasets<a class="hash-link" href="#datasets" title="Direct link to heading">​</a></h2><p>Session data has many important characteristics:</p><ul><li>Session clicks and navigation are sequential by nature. The order of clicks as well as the navigational path may contain information about user intent.</li><li>Viewed items often have metadata such as names, categories, and descriptions, which provides information about the user’s tastes and what they are looking for.</li><li>Sessions are limited in time and scope. A session has a specific goal and generally ends once that goal is accomplished: rent a hotel for a business trip, find a restaurant for a romantic date, and so on. This means that the session has intrinsic informational power related to a specific item (such as the hotel or restaurant that’s eventually booked).</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="diginetica">Diginetica<a class="hash-link" href="#diginetica" title="Direct link to heading">​</a></h3><p>Diginetica is a dataset that comes from CIKM Cup 2016. Its transaction data is suitable for session-based recommendation.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="yoochoose">Yoochoose<a class="hash-link" href="#yoochoose" title="Direct link to heading">​</a></h3><p>The dataset is session-based and each session contains a sequence of clicks and purchases. Since the Yoochoose dataset is too large, in some cases we only use its the most recent 1/64 fractions of the training sessions, denoted as Yoochoose 1/64.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="preprocessing">Preprocessing<a class="hash-link" href="#preprocessing" title="Direct link to heading">​</a></h2><p>In general, we do the following preprocessing operations on the sessions data - </p><ol><li>Drop all unit-length sessions.</li><li>Remove items with less than <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> interactions.</li><li>Remove items that appear less than <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span></span> no. of times.</li><li>Take session of last <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span> days/weeks as test set.</li><li>For an existing session, generate a series of input session sequences and corresponding labels.</li><li>Filter out items from the test set which do not appear in the training set.</li><li>Keep only <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span></span> most popular items/users.</li><li>Partition the log into sessions by applying user inactivity threshold of time duration <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span></span>.</li><li>Replace multiple consecutive clicks (or in general, event) on the same item by a single click on that item.</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="baseline-methods">Baseline methods<a class="hash-link" href="#baseline-methods" title="Direct link to heading">​</a></h3><table><thead><tr><th>Model</th><th>Description</th></tr></thead><tbody><tr><td>Item-KNN</td><td>Item-KNN is a neighborhood method that recommends items that are similar to the previous items in the current session, where the similarity between two items is defined by their cosine similarity.</td></tr><tr><td>Markov Chain</td><td>Markov chains predicts the user’s next action solely based on the previous action. But such a strong independence assumption suffers from noisy data.</td></tr><tr><td>FPMC</td><td>FPMC is a Markov-chain based method for next-basket recommendation. To adapt it for session-based recommendation, we consider the next item as the next basket.</td></tr><tr><td>GRU4Rec</td><td>GRU4Rec models short-term preferences with gated recurrent units (GRUs).</td></tr><tr><td>NARM</td><td>NARM employs RNNs with attention to capture user’s main purposes and sequential behaviors. Two RNN-based subsystems to capture users’ local and global preference respectively.</td></tr><tr><td>STAMP</td><td>STAMP extracts users’ potential interests using a simple multilayer perceptron model and an attentive network.</td></tr><tr><td>NextItNet</td><td>NextItNet is a CNN-based method for next-item recommendation. It uses dilated convolution to increase the receptive fields without using the lossy pooling operations.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="gnn-based-methods">GNN-based methods<a class="hash-link" href="#gnn-based-methods" title="Direct link to heading">​</a></h3><table><thead><tr><th>Model</th><th>Description</th></tr></thead><tbody><tr><td>SR-GNN</td><td>SR-GNN first models all session sequences as session graphs. Then, each session graph is proceeded one by one and the resulting node vectors can be obtained through a gated graph neural network. After that, each session is represented as the combination of the global preference and current interests of this session using an attention net. Finally, it predict the probability of each item that will appear to be the next-click one for each session.</td></tr><tr><td>GC-SAN</td><td>GC-SAN uses a GGNN to extract local context information and a self-attention network (SAN) to capture global dependencies between distant positions.</td></tr><tr><td>FGNN</td><td>FGNN converts a session into a weighted directed graph where the edge weights are the counts of item transitions. An adapted multi-layered graph attention network (GAT) is used to extract item features and a modified Set2Set pooling operator is applied to generate session representations.</td></tr><tr><td>LESSR</td><td>Given a session, LESSR compute an edge-order preserving (EOP) multigraph and a shortcut graph. The graphs and the node representations are passed as input to multiple interleaved EOPA and SGAT layers. Each layer outputs the new node representations. The readout layer computes a graph-level representation, which is combined with the recent interests to form the session embedding. Finally, the prediction layer computes the probability distribution of the next item.</td></tr><tr><td>GCE_GNN</td><td>GCE-GNN first construct a global graph based on all training session sequences. Then for each session, a global feature encoder and local feature encoder is used to extract node feature with global context and local context. Then the model incorporates position information to learn the contribution of each item to the next predicted item. Finally, candidate items are scored.</td></tr><tr><td>DGTN</td><td>DGTN propagate the embeddings of neighbor items in the target session and the neighbor session set towards the next layer in the intra- and intersession channel, respectively. Then the embeddings of the final layer in the two channels are fed into the fusion function to obtain the final item embedding. Based on the learned item embeddings, it generate the session embedding via session pooling. Finally, a prediction layer is applied to generate the recommendation probability.</td></tr><tr><td>TAGNN</td><td>TAGNN first models all session sequences as session graphs. Then, graph neural networks capture rich item transitions in sessions. Lastly, from one session embedding vector, target-aware attention adaptively activates different user interests concerning varied target items to be predicted.</td></tr><tr><td>TAGNN++</td><td>TAGNN models item interactions with GNN, and both local and global user interactions with  a Transformer.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="sr-gnn">SR-GNN<a class="hash-link" href="#sr-gnn" title="Direct link to heading">​</a></h2><p><em><a href="https://arxiv.org/abs/1811.00855" target="_blank" rel="noopener noreferrer">Wu et. al. Session-based Recommendation with Graph Neural Networks. AAAI, 2019.</a></em></p><p>SR-GNN first models all session sequences as session graphs. Then, each session graph is proceeded one by one and the resulting node vectors can be obtained through a gated graph neural network. After that, each session is represented as the combination of the global preference and current interests of this session using an attention net. Finally, it predict the probability of each item that will appear to be the next-click one for each session.</p><p><img alt="The workflow of the proposed SR-GNN method." src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-2-e5da1eacdb289e26c020cbbf88223f8c.png"></p><p>The workflow of the proposed SR-GNN method.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="gc-san">GC-SAN<a class="hash-link" href="#gc-san" title="Direct link to heading">​</a></h2><p><a href="https://www.ijcai.org/proceedings/2019/0547.pdf" target="_blank" rel="noopener noreferrer"><em>Xu et. al. Graph Contextualized Self-Attention Network for Session-based Recommendation. IJCAI, 2019.</em></a></p><p>Graph contextualized self-attention model (GC-SAN) utilizes both graph neural network and self-attention mechanism, for session-based recommendation. It dynamically construct a graph structure for session sequences and capture rich local dependencies via graph neural network (GNN). Then each session learns long-range dependencies by applying the self-attention mechanism. Finally, each session is represented as a linear combination of the global preference and the current interest of that session.</p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-3-7ea3a090d360192c82754c70d7b18e32.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="fgnn">FGNN<a class="hash-link" href="#fgnn" title="Direct link to heading">​</a></h2><p><em><a href="https://arxiv.org/abs/1911.11942" target="_blank" rel="noopener noreferrer">Qiu et. al. Rethinking the Item Order in Session-based Recommendation with Graph Neural Networks. CIKM, 2019.</a></em></p><p>FGNN converts a session into a weighted directed graph where the edge weights are the counts of item transitions. An adapted multi-layered graph attention network (GAT) is used to extract item features and a modified Set2Set pooling operator is applied to generate session representations.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="lessr">LESSR<a class="hash-link" href="#lessr" title="Direct link to heading">​</a></h2><p><em><a href="https://dl.acm.org/doi/pdf/10.1145/3394486.3403170" target="_blank" rel="noopener noreferrer">T. Chen and R. Wong, Handling Information Loss of Graph Neural Networks for Session-based Recommendation. KDD, 2020.</a></em></p><p>Given a session, LESSR compute an edge-order preserving (EOP) multigraph and a shortcut graph. The graphs and the node representations are passed as input to multiple interleaved EOPA and SGAT layers. Each layer outputs the new node representations. The readout layer computes a graph-level representation, which is combined with the recent interests to form the session embedding. Finally, the prediction layer computes the probability distribution of the next item.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="gce-gnn">GCE-GNN<a class="hash-link" href="#gce-gnn" title="Direct link to heading">​</a></h2><p><em><a href="https://arxiv.org/abs/2106.05081" target="_blank" rel="noopener noreferrer">Wang etl. al. Global Context Enhanced Graph Neural Networks for Session-based Recommendation. arXiv, 2021.</a></em></p><p>GCE-GNN first construct a global graph based on all training session sequences. Then for each session, a global feature encoder and local feature encoder is used to extract node feature with global context and local context. Then the model incorporates position information to learn the contribution of each item to the next predicted item. Finally, candidate items are scored.</p><p><img alt="An overview of the proposed framework." src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-4-22ec10bb9dcfaa871ddbab561c5b240b.png"></p><p>An overview of the proposed framework.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="dgtn">DGTN<a class="hash-link" href="#dgtn" title="Direct link to heading">​</a></h2><p><em><a href="https://arxiv.org/abs/2009.10002" target="_blank" rel="noopener noreferrer">Zheng et. al. Dual-channel Graph Transition Network for Session-based Recommendation. arXiv, 2020.</a></em></p><p>DGTN propagate the embeddings of neighbor items in the target session and the neighbor session set towards the next layer in the intra- and intersession channel, respectively. Then the embeddings of the final layer in the two channels are fed into the fusion function to obtain the final item embedding. Based on the learned item embeddings, it generate the session embedding via session pooling. Finally, a prediction layer is applied to generate the recommendation probability.</p><p><img alt="An illustration of the model architecture." src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-5-e9a79ac5248faf58d5f6b1c38be0946c.png"></p><p>An illustration of the model architecture.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tagnn">TAGNN<a class="hash-link" href="#tagnn" title="Direct link to heading">​</a></h2><p><a href="https://arxiv.org/abs/2005.02844" target="_blank" rel="noopener noreferrer"><em>Yu et. al. Target Attentive Graph Neural Networks for Session-based Recommendation. SIGIR, 2020.</em></a></p><p>TAGNN first models all session sequences as session graphs. Then, graph neural networks capture rich item transitions in sessions. Lastly, from one session embedding vector, target-aware attention adaptively activates different user interests concerning varied target items to be predicted.</p><p><img alt="An overview of the proposed TAGNN method." src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-6-5d582d3b4583da152ed6a3e79e974725.png"></p><p>An overview of the proposed TAGNN method.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tagnn-1">TAGNN++<a class="hash-link" href="#tagnn-1" title="Direct link to heading">​</a></h2><p><em><a href="https://arxiv.org/abs/2107.01516v2" target="_blank" rel="noopener noreferrer">Mitheran et. al. Improved Representation Learning for Session-based Recommendation. arXiv, 2021.</a></em></p><p>TAGNN models item interactions with GNN, and both local and global user interactions with  a Transformer.</p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-7-83644f2ab0364fd6ce44c87c46ed02c3.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><p>Despite the convenient representation of sessions offered by GNNs, it lacks the ability to model long-range dependencies and complicated interactions. One common issue is the lossy session encoding in which some sequential information about item transitions is ignored because of the lossy encoding from sessions to graphs and the permutation-invariant aggregation during message passing. Another common issue is the GNN&#x27;s ineffectiveness in capturing long-range dependencies within sessions due to the limited number of layers.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="lossy-session-encoding-problem">Lossy Session Encoding Problem<a class="hash-link" href="#lossy-session-encoding-problem" title="Direct link to heading">​</a></h3><p>It is due to their lossy encoding schemes that convert sessions to graphs. To process sessions using a GNN, the sessions need to be converted to graphs first. In these methods, each session is converted to a directed graph whose nodes are the unique items in the session and the edges are the transitions between items. The edges can be either weighted or unweighted.</p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-8-ab0491c7687fdb0c342894fab2e48794.png"></p><p>Two different sessions <!-- -->[<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">v_1, v_2, v_3, v_3, v_2, v_2, v_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>]<!-- --> and <!-- -->[<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">v_1, v_2, v_2, v_3, v_3, v_2, v_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>]<!-- --> are converted to the same graph.</p><p>Although in a particular dataset, the two sessions may produce the same next item, there may also exist a dataset in which the two sessions produce different next items. In the latter case, it is not possible for these GNN models to make correct recommendations for both sessions. Therefore, these models have a limitation in their modeling capacity.</p><p>Lossy conversion could be problematic because the information ignored may be important to determine the next item. We should let the model automatically learn to decide what information can be ignored instead of “blindly” making the decision using a lossy conversion method. Otherwise, the model is not flexible enough to fit complex datasets since its modeling capacity is limited by the lossy conversion method.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="oversmoothing-problem">Oversmoothing Problem<a class="hash-link" href="#oversmoothing-problem" title="Direct link to heading">​</a></h3><p>Over-smoothing is caused as they use only the embeddings updated through the last layer in the prediction layer. Specifically, as the number of layers increases, the embedding of a node will be influenced more from its neighbors’ embeddings. As a result, the embedding of a node in the last layer becomes similar to the embeddings of many directly/indirectly connected nodes. This phenomenon prevents most of the existing GCN-based methods from effectively utilizing the information of high-order neighborhood. Empirically, this is also shown by the fact that most of non-linear GCN-based methods show better performance when using only a few layers instead of deep networks.</p><p>Most common way to handle this is by <strong>Residual Prediction</strong> i.e. utilize the embeddings from all layers for prediction. After that, perform residual prediction, which predict each user’s preference to each item with the multiple embeddings from the multiple layers.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tutorials">Tutorials<a class="hash-link" href="#tutorials" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sr-gnn-session-based-recommendation-on-sample-dataset">SR-GNN Session-based Recommendation on Sample dataset<a class="hash-link" href="#sr-gnn-session-based-recommendation-on-sample-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/9cc4447495dfd6465698b8d99afc2316" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-9-fc85728b40f9ca32eef023a8220b1b91.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tagnn-session-based-recommendation-on-sample-dataset">TAGNN Session-based Recommendation on Sample dataset<a class="hash-link" href="#tagnn-session-based-recommendation-on-sample-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/64f5ed5f288b03693880ddf94b56b6c2" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The flow diagram of this is same as SR-GNN, the difference is in the implementation of <code>SessionGraph()</code> module mainly.</p></div></div><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-10-fc85728b40f9ca32eef023a8220b1b91.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tagnn-session-based-recommendation-on-diginetica-and-yoochose-dataset">TAGNN++ Session-based Recommendation on Diginetica and Yoochose dataset<a class="hash-link" href="#tagnn-session-based-recommendation-on-diginetica-and-yoochose-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/f506616b853cad89c76c8e3ca2e0c105" target="_blank" rel="noopener noreferrer">direct link to notebook (diginetica) →</a></p><p><a href="https://nbviewer.org/gist/sparsh-ai/339575ed65f760ee2d9d21f3f977bb67" target="_blank" rel="noopener noreferrer">direct link to notebook (yoochoose) →</a></p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-11-697118acb1c81fbff096dc8d6fc2a837.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="gc-san-implementation-in-pytorch">GC-SAN implementation in PyTorch<a class="hash-link" href="#gc-san-implementation-in-pytorch" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/25d725cd3ffb43ef711fcd3ac13390a6" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-12-03aeef4d9eeae932bced7373ca5777eb.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="lessr-session-based-recommendation-on-sample-dataset">LESSR Session-based Recommendation on Sample dataset<a class="hash-link" href="#lessr-session-based-recommendation-on-sample-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/2187689c8f2ecda58a0e5d5510f077ef" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-13-dde727ed91a4bf7cd619f2c9b854f7f3.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="gce-gnn-session-based-recommendation-on-diginetica-tmall-and-nowplaying-dataset">GCE-GNN Session-based Recommendation on Diginetica, Tmall and NowPlaying dataset<a class="hash-link" href="#gce-gnn-session-based-recommendation-on-diginetica-tmall-and-nowplaying-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/0255e6fadc347db81ba360e8d2d571c4" target="_blank" rel="noopener noreferrer">direct link to notebook (diginetica)→</a> </p><p><a href="https://nbviewer.org/gist/sparsh-ai/ac9c8e27612e9a4656f06376aa260d6a" target="_blank" rel="noopener noreferrer">direct link to notebook (tmall)→</a></p><p><a href="https://nbviewer.org/gist/sparsh-ai/83ed18af8d234d9745cfd7b2ddaf8da0" target="_blank" rel="noopener noreferrer">direct link to notebook (nowplaying)→</a></p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-14-e77977e19bcf721b83e52fe4894ac724.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fgnn-session-based-recommendation-on-sample-dataset">FGNN Session-based Recommendation on Sample dataset<a class="hash-link" href="#fgnn-session-based-recommendation-on-sample-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/642d10ae901e3bb8b8821070ad689b71" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><p><img alt="Untitled" src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-15-e20e5630200b95ba2a8da5e66dc3017c.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="conversion-of-sessions-into-session-graph-on-yoochoose-dataset">Conversion of sessions into Session graph on Yoochoose dataset<a class="hash-link" href="#conversion-of-sessions-into-session-graph-on-yoochoose-dataset" title="Direct link to heading">​</a></h3><p><a href="https://nbviewer.org/gist/sparsh-ai/d732e7c3cf42dc5f26c551cd88b8641c" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="session-graph-with-attention-in-pytorch">Session graph with attention in PyTorch<a class="hash-link" href="#session-graph-with-attention-in-pytorch" title="Direct link to heading">​</a></h3><p><a href="https://gist.github.com/sparsh-ai/a47acac562c6801f4bd37196e251fd88" target="_blank" rel="noopener noreferrer">direct link to notebook →</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="preprocessing-of-session-datasets">Preprocessing of session datasets<a class="hash-link" href="#preprocessing-of-session-datasets" title="Direct link to heading">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>python notebooks</h5></div><div class="admonition-content"><p><a href="https://nbviewer.org/gist/sparsh-ai/12d1f5ca07add606f27b0f841b550a82" target="_blank" rel="noopener noreferrer">Preprocessing of Sample session dataset</a></p><p><a href="https://nbviewer.org/gist/sparsh-ai/fbaf4627cbd3fe5b45efc2f6ab50920a" target="_blank" rel="noopener noreferrer">Preprocessing of Diginetica session dataset</a></p><p><a href="https://nbviewer.org/gist/sparsh-ai/43b1bfb234971380b4f3179244bc25f5" target="_blank" rel="noopener noreferrer">Preprocessing of Gowalla session dataset</a></p><p><a href="https://nbviewer.org/gist/sparsh-ai/512750bd6427d98ca396d041abf421ac" target="_blank" rel="noopener noreferrer">Preprocessing of LastFM session dataset</a></p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="appendix">Appendix<a class="hash-link" href="#appendix" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="session-graph">Session Graph<a class="hash-link" href="#session-graph" title="Direct link to heading">​</a></h3><p><img alt="An example of a session graph and the connection matrix $A_s$." src="/assets/images/content-tutorials-raw-session-based-recommendation-with-graph-neural-net-untitled-16-39b1da2f831f6de2f48c98eec62f98ff.png"></p><p>An example of a session graph and the connection matrix <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/recohut/docs/docs/docs/tutorials/session-based-recommendation-with-graph-neural-net.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Real-time event capturing with Kafka and MongoDB</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tutorials/tensorflow-2-reinforcement-learning-cookbook"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TensorFlow 2 Reinforcement Learning Cookbook</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#datasets" class="table-of-contents__link toc-highlight">Datasets</a><ul><li><a href="#diginetica" class="table-of-contents__link toc-highlight">Diginetica</a></li><li><a href="#yoochoose" class="table-of-contents__link toc-highlight">Yoochoose</a></li></ul></li><li><a href="#preprocessing" class="table-of-contents__link toc-highlight">Preprocessing</a></li><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a><ul><li><a href="#baseline-methods" class="table-of-contents__link toc-highlight">Baseline methods</a></li><li><a href="#gnn-based-methods" class="table-of-contents__link toc-highlight">GNN-based methods</a></li></ul></li><li><a href="#sr-gnn" class="table-of-contents__link toc-highlight">SR-GNN</a></li><li><a href="#gc-san" class="table-of-contents__link toc-highlight">GC-SAN</a></li><li><a href="#fgnn" class="table-of-contents__link toc-highlight">FGNN</a></li><li><a href="#lessr" class="table-of-contents__link toc-highlight">LESSR</a></li><li><a href="#gce-gnn" class="table-of-contents__link toc-highlight">GCE-GNN</a></li><li><a href="#dgtn" class="table-of-contents__link toc-highlight">DGTN</a></li><li><a href="#tagnn" class="table-of-contents__link toc-highlight">TAGNN</a></li><li><a href="#tagnn-1" class="table-of-contents__link toc-highlight">TAGNN++</a></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#lossy-session-encoding-problem" class="table-of-contents__link toc-highlight">Lossy Session Encoding Problem</a></li><li><a href="#oversmoothing-problem" class="table-of-contents__link toc-highlight">Oversmoothing Problem</a></li></ul></li><li><a href="#tutorials" class="table-of-contents__link toc-highlight">Tutorials</a><ul><li><a href="#sr-gnn-session-based-recommendation-on-sample-dataset" class="table-of-contents__link toc-highlight">SR-GNN Session-based Recommendation on Sample dataset</a></li><li><a href="#tagnn-session-based-recommendation-on-sample-dataset" class="table-of-contents__link toc-highlight">TAGNN Session-based Recommendation on Sample dataset</a></li><li><a href="#tagnn-session-based-recommendation-on-diginetica-and-yoochose-dataset" class="table-of-contents__link toc-highlight">TAGNN++ Session-based Recommendation on Diginetica and Yoochose dataset</a></li><li><a href="#gc-san-implementation-in-pytorch" class="table-of-contents__link toc-highlight">GC-SAN implementation in PyTorch</a></li><li><a href="#lessr-session-based-recommendation-on-sample-dataset" class="table-of-contents__link toc-highlight">LESSR Session-based Recommendation on Sample dataset</a></li><li><a href="#gce-gnn-session-based-recommendation-on-diginetica-tmall-and-nowplaying-dataset" class="table-of-contents__link toc-highlight">GCE-GNN Session-based Recommendation on Diginetica, Tmall and NowPlaying dataset</a></li><li><a href="#fgnn-session-based-recommendation-on-sample-dataset" class="table-of-contents__link toc-highlight">FGNN Session-based Recommendation on Sample dataset</a></li><li><a href="#conversion-of-sessions-into-session-graph-on-yoochoose-dataset" class="table-of-contents__link toc-highlight">Conversion of sessions into Session graph on Yoochoose dataset</a></li><li><a href="#session-graph-with-attention-in-pytorch" class="table-of-contents__link toc-highlight">Session graph with attention in PyTorch</a></li><li><a href="#preprocessing-of-session-datasets" class="table-of-contents__link toc-highlight">Preprocessing of session datasets</a></li></ul></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#session-graph" class="table-of-contents__link toc-highlight">Session Graph</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Introduction</a></li><li class="footer__item"><a href="https://nb.recohut.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Notebooks</a></li><li class="footer__item"><a href="https://step.recohut.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stories</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/recohut/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Recohut Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cb8160eb.js"></script>
<script src="/assets/js/main.fedda83c.js"></script>
</body>
</html>