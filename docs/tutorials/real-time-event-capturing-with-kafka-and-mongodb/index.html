<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-react-helmet="true">Real-time event capturing with Kafka and MongoDB | Recohut</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.recohut.com/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Real-time event capturing with Kafka and MongoDB | Recohut"><meta data-react-helmet="true" name="description" content="| | |"><meta data-react-helmet="true" property="og:description" content="| | |"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.recohut.com/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb"><link data-react-helmet="true" rel="alternate" href="https://docs.recohut.com/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.recohut.com/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8d002642.css">
<link rel="preload" href="/assets/js/runtime~main.1c09e74f.js" as="script">
<link rel="preload" href="/assets/js/main.0b9e1a49.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Recohut Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Recohut Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Recohut</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/recohut/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/concept-basics/challenges">Concept - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/concept-extras/bias-&amp;-fairness">Concept - Extras</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/models/">Models</a><button aria-label="Toggle the collapsible sidebar category &#x27;Models&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/data-science-bookcamp">Data Science Bookcamp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/matching-and-ranking-models-in-tensorflow">Matching and Ranking models in Tensorflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb">Real-time event capturing with Kafka and MongoDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/session-based-recommendation-with-graph-neural-net">Session-based Recommendation with Graph Neural Networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/tensorflow-2-reinforcement-learning-cookbook">TensorFlow 2 Reinforcement Learning Cookbook</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/datasets">Datasets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/projects">Projects</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Real-time event capturing with Kafka and MongoDB</h1></header><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Problem</td><td>Real-time event capturing is important in recommender systems because consumer behavior and underlying patterns changes rapidly. But how to capture these events in real-time?</td></tr><tr><td>Solution</td><td>There are many tools and technologies to capture events (clickstream) in real-time and also train/infer real-time recommendations. Kafka + MongoDB is one such set of tools/techs for this objective. We will use Kafka producer at the user&#x27;s endpoint to send the events to a Kafka consumer/listener via a relevant topic stream (called Kafka topic). Then this received events can directly be fed into recsys training process. We will store these events in MongoDB for long-term persistence.</td></tr><tr><td>Dataset</td><td>ML-100k</td></tr><tr><td>Preprocessing</td><td>We will convert the records into JSON format.</td></tr><tr><td>Tools</td><td>Kafka, MongoDB</td></tr><tr><td>Tags</td><td>EventCapture, RealTime, Kafka, MongoDB, CloudKarafka, Atlas, Clickstream</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="whyisthisimportant">WhyÂ isÂ thisÂ important?<a class="hash-link" href="#whyisthisimportant" title="Direct link to heading">â€‹</a></h2><ul><li>Real-time capture of event is very important to serve real-time recommendations</li><li>Everything is on cloud</li><li>Free of cost to start with at least (and to run this experiment obviously)</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="howitwillwork">HowÂ itÂ willÂ work?<a class="hash-link" href="#howitwillwork" title="Direct link to heading">â€‹</a></h2><p><img src="https://github.com/RecoHut-Stanzas/S307784/raw/main/images/S307784%20%7C%20Real-time%20event%20capturing%20with%20Kafka%20and%20MongoDB.drawio.svg" alt="https://github.com/RecoHut-Stanzas/S307784/raw/main/images/S307784%20%7C%20Real-time%20event%20capturing%20with%20Kafka%20and%20MongoDB.drawio.svg"></p><ol><li>Setup kafka and mongodb clusters</li><li>Configure the connnections in colab notebooks by saving the right credentials</li><li>Load and prepare movielens dataset</li><li>Start Kafka producer, consumer and mongodb listener notebooks</li><li>Send a record from kafka producer to kafka consumer</li><li>Save the received record in mongodb</li><li>Read the record from mongodb stream and convert into pandas dataframe</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setup-kafka">Setup Kafka<a class="hash-link" href="#setup-kafka" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sign-up">Sign-up<a class="hash-link" href="#sign-up" title="Direct link to heading">â€‹</a></h3><p>Go to <a href="https://customer.cloudkarafka.com/signup" target="_blank" rel="noopener noreferrer">this</a> link and signup</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-a-team">Create a team<a class="hash-link" href="#create-a-team" title="Direct link to heading">â€‹</a></h3><p>Enter a team name and create the team. Below is the settings that I used:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-50d1b1c04307690fd719d56fb4409213.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-an-instance">Create an instance<a class="hash-link" href="#create-an-instance" title="Direct link to heading">â€‹</a></h3><p>Click on <em>Create New Instance</em> button and fill-out the details. For instance, I filled the below ones in my case:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-1.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-1-05beba02aef2bf3ad8396f80da2a1764.png"></p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-2.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-2-a6309089ecb18e7aede7dbd3f4d673b9.png"></p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-3.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-3-b3365cc156da850035d7c2547e17eb7f.png"></p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-4.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-4-8415bfb3ad1d07d757523b94ccb45a69.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-kafka-topic">Create Kafka topic<a class="hash-link" href="#create-kafka-topic" title="Direct link to heading">â€‹</a></h3><p>Click on the kafka instance and you will see something like this:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-5.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-5-fbf6f18339f189ba6e5fd2c42c615856.png"></p><p>We will be needing these details to configure Kafka in our notebook.</p><p>For now, let&#x27;s create a topic first. Click on topic tab, from left-side navigation pane.</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-6.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-6-d3095b040cafec36c4c6dd20a3e4fb69.png"></p><p>You can use default one also, but for our use case, we are creating a new topic named &quot;&lt;user_name&gt;-&lt;topic_name&gt;&quot;.</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-7.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-7-ea24623e8975ca57b11c45e906179cb1.png"></p><p>Keep this instance detail page open or note down the details safely. We will be needing these details later.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setup-mongodb">Setup MongoDB<a class="hash-link" href="#setup-mongodb" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sign-up-1">Sign up<a class="hash-link" href="#sign-up-1" title="Direct link to heading">â€‹</a></h3><p>Go to <a href="https://account.mongodb.com/account/register?n=%2Fv2%2F6056079edc5be0371e355b11&amp;nextHash=%23clusters" target="_blank" rel="noopener noreferrer">this</a> link and sign-up. I used <em>Sign up with Google</em> option.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-organization">Create organization<a class="hash-link" href="#create-organization" title="Direct link to heading">â€‹</a></h3><p>I got this as my welcome page:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-8.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-8-1c58edd4def21636c26798edd31dc886.png"></p><p>Click on <em>Create an Organization.</em> Give it a name and click on <em>Next:</em></p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-9.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-9-06108ab673c961084907444c78ce4c89.png"></p><p>Click on <em>Create Organization</em>:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-10.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-10-a4d1b0e692bfd74b2f9d68e19e14d9dc.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-a-project">Create a project<a class="hash-link" href="#create-a-project" title="Direct link to heading">â€‹</a></h3><p>Click on <em>Create New Project</em>, name it and click on <em>Next</em>:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-11.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-11-b4aba87cfd09221b3eaa135d76f8c241.png"></p><p>Then, click on <em>Create Project</em>:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-12.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-12-77337855f1997fd07062edfa77397bbe.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-a-cluster">Create a cluster<a class="hash-link" href="#create-a-cluster" title="Direct link to heading">â€‹</a></h3><p>Click on <em>Build a Cluster</em>:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-13.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-13-301bbbd48bb5f6328640241947b19494.png"></p><p>Choose the free version:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-14.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-14-e05eadf059bf624b0d10bc6aed0a723a.png"></p><p>Click on <em>Create Cluster</em>:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-15.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-15-7efba940d615cdfa0a36506f587cc0ac.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configure-user">Configure user<a class="hash-link" href="#configure-user" title="Direct link to heading">â€‹</a></h3><p>Click on <em>CONNECT</em> button and select <em>Connect from anywhere.</em> A default IP 0.0.0.0 will come and click Ok. </p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-16.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlwAAABHCAYAAADSkpnBAAAZU0lEQVR4Ae2dWZBVRZrHO2JiJibmZR76ZV76bR7mYR4nJuZhHmeMHsNuu7VtR0e73bVRcUVpBlxwRxTZQdlUFNllEQTZZVOUYrMKKKgCqliKKpYCiqqiKL6JX9pfmffUubduFRytO/efETfOuXkyv/zyl3lP/s93suBnpiQCIiACIiACIiACIpApgZ9lal3GRUAEREAEREAEREAETIJLk0AEREAEREAEREAEMiYgwZUxYJkXAREQAREQAREQAQkuzQEREAEREAEREAERyJiABFfGgGVeBERABERABERABCS4NAdEQAREQAREQAREIGMCElwZA5Z5ERABERABERABEZDg0hwQAREQAREQAREQgYwJSHBlDFjmRUAEREAEREAERECCS3NABERABERABERABDImIMGVMWCZFwEREAEREAEREAEJLs0BERABERABERABEciYgARXxoBlXgREQAREQAREQAQkuDQHREAEREAEREAERCBjAhJcGQOWeREQAREQAREQARGQ4NIcEAEREAEREAEREIGMCVwTwVVZtddGj59o9zz4J/uvG28KH87J45qSCIiACIiACIiACJQzgasWXIiq6264seCHMkoiIAIiIAIiIAIiUK4ErkpwDXnuhYJCKxZilFX68Qh88+32MDYclURABERABERABH5aAn0WXPkiW9t37LRDh4+kCrFiIl2nz5yxex96uCixsHDxklCWOsnkdihTjikrwTVm/ES75fY77WBNbcAK31hYc874pY1Jb8eh0PjSv9iP3tpWeREQAREQARH4MQn0SXCxLyu5yM6cNds6OjqC7/kEF3V62tPlQoGyLO6FUqEFudwEFwIIAZJ1RKsYwcXYDX1huLW2thYavh6vFRpfCa4e8amACIiACIhAPyLQJ8GVL7rFQlsowsX1nqJcLOhESFiwk5ESFnDysYO4eG3EyJwysVjz+izaaYl87PinkFDBJy8Xi0AXdX4tboty+PDx7Dlddb0NFwsrVq0O/aB+bNfFU5rd+JpHeOI86tDu5i1bQ7veZl99TbLDT2+Xa87R2yGPMvgR57mdpB/46sKsp/F1u87L/fD+w5o82o1tOZO0drgWj1vSv7Q+eF90FAEREAEREIFiCfRJcPEXiCxUaZ+eBBd18yVf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"></p><p>Click on <em>Connect</em> and enter username and password:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-17.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfkAAABXCAYAAAAH1zzOAAAgAElEQVR4Ae2dV4xdx33GDQQJgiBAHvzilyBBkAcbyEOCBHGABMmLY9iOHdtyZEeK7ahEliyrd9PqVhfVqC5RElVpihJJVYqSWEUVFnFZxCb2Iva27H2C36y+5X9H5969W7i8u/4GuJpz5vznX74p38ycQ+2XkpMRMAJGwAgYASMwIBH40oCMykEZASNgBIyAETACySTvTmAEjIARMAJGYIAiYJIfoA3rsIyAETACRsAImOTdB4yAETACRsAIDFAETPIDtGEdlhEwAkbACBgBk7z7gBEwAkbACBiBAYqASX6ANqzDMgJGwAgYASNgkncfMAJGwAgYASMwQBEwyQ/QhnVYRsAIGAEjYARM8u4DRsAIGAEjYAQGKAIm+QHasA7LCBgBI2AEjIBJ3n3ACBgBI2AEjMAARaBhkl+wcFG678GH0xln/zJ9+/sn5R/XlPHMyQgYASNgBIyAEWguBBoieYj8m9/9ft0fMk5GwAgYASNgBIxA8yDQKckPuvb6uuQeyR9ZJyNgBIyAETACRqA5EKhL8lU7+JWrVrd7PnbcO19YADSyo5/58awO9a6+/sa0b9++dr396WLZ8hXp5FN/1iEeFj6jX32t18OQLfA7EUn2hxSnNsRKzCfKrxOBhW0aASNgBPoDAjVJnvfscZfONaS+d+/edPtd96RZs+e0X5dy9d7RixDKOseD6CGj46E3NqyIr4yH+5IMYz1dq34jBNkVWenvzVz2y7jUpo3E0Jv+WJcRMAJGwAjUR6AmyVft4iH2zVu2pCsGXdOB8EuCq7WbF0mw8+VaSSRBDlHw/IURL+YcOdWTHeSUtm3fns4851ftCxKROkQkeXL0clrAc5VLVrpijrzkyKPNKCff4nOVxTh5HvWhX3Iqlz+1bEte2FAvEm4tLPC3fIYNJemVHzEWyZBLLtqkXLFJZz1bZWyqI92KTeXRvq+NgBEwAkagawjUJHm+nNekX+aQPGTP0X35jHvqViVN8LVIhDqSQQ8kOfm9qZXH4ciVpC1f0F+S/AcfTutA8JItCQsfRDiSkS+Ul0myZUwiPvIYk3SyMGmZM7dDbJA8pyDELbloW7biM66JoR4WVc+0AKmlE5/LJNkSM8Vaq01kqwoHPZNuxVZlv/TH90bACBgBI1AfgZokzz+T04Rb5pC7dvTlM+6pW5UiGVQ9p0xEICJRndIOz7VjlGx5T7l2xyWJSB9kS72Y5IOIpryPstKLnzGpDuX8RGbIxHvVr2VLesglq3hF3sSwYuWqfKKhZxEL1ZOP1OMaGXJhEXPpiTFJT/lMOqKPVbaoF23oGlnpVntFu742AkbACBiB7iHQZZLvjOCZuGuRvAhLBFDlMjIlIYoMYi4yqCIOkRC55EQiUQfX0Zb8EUGWsvhWJuktY4qxSibqk109k+56tktZfMGudNXCQouBaF+LG+rHcl0Ltxiv7AtfPZMOYqhnq8o/7FEu3cJBup0bASNgBIxA9xGoSfJVx/W8ky+TPsQTOZDXOq7XRI5MnMxFEkz2lIu0sKVnUX7+goWZTCiLuqRfJEQusiqfoXvd+g35V8ZEPZFgLR9UR3rxU0lETRwLFi3OPsgPZNCvGFVf8dWzLVlkSCJUfJ04ZUpdLPAJeekAN/TUw1fxKFdcERv5ENuhlq0Yt3Qqbvmlez13bgSMgBEwAt1HoCbJV314x0TeyK/Wh3e4KVIp9Yg4mORFgMiLWEp5SLPq/TVyIkFy1UNvvFd5tCUYa/lYRUAiJ+mLeZUfei67sT4xjXx5dLvPkiXHdpSNz7DTnWforIcvBF6mKgzxRYuYWn406n8VxqUPvjcCRsAIGIHGEKhJ8lX/hC4SS73rev+EDreYyGN9EYSeiQAVQklEcdccCXnoU8Pav7SnPNoReUSSinZlizzuTvGFL77xt/QL2VqkFn2M/rOYwU/0cb1+w4ZMkNzjz/YdO9rvS9v6CFFfoFNHCwl8qYdF6Wct/9AZn0VcdB0xlN9xQVDPVvlM7aJy3cuWcyNgBIyAEeg+AjVJHpXd2c3X28V3303XNAJGwAgYASNgBLqKQF2SR5n/t7ZdhdTyRsAIGAEjYASaA4FOSR43G9nRewffHA1qL4yAETACRsAICIGGSB5h3rND5Hw57z81K/icGwEjYASMgBFoXgQaJvnmDcGeGQEjYASMgBEwAlUImOSrUHGZETACRsAIGIEBgIBJfgA0okMwAkbACBgBI1CFgEm+ChWXGQEjYASMgBEYAAiY5AdAIzoEI2AEjIARMAJVCJjkq1BxmREwAkbACBiBAYCASX4ANKJDMAJGwAgYASNQhYBJvgoVlxkBI2AEjIARGAAI9AuSn7V1yQCA2iEYASNgBIyAEehbBJqe5Ae1PJG+/OJJibxWWr1mTfr5mb9Is+fMrRTRX4EbOuzpDs937GhN5154Sad/da1DpR7cxL/e9q3//GE6/5LL0tJly9s1xr+ax193Q2bQdTekrVu3tcv0xQV+xL9u11Obva2vp/7QH4gv/uU86eQv8HXlL+F1VV526uXoLP8SIL7eesfg/FcP69XtjWfgw19EJHcyAkagfyPQ1CQPsf/5qFPThA2z66LMhHjWueenBx5+NB09evQLskxW55x/UbrsqkEJYleaMfPj/OdeywlVz3s7h1hEIPj50fQZeZGxcdOmbKokQ2Sefu75VC5OetuvUl/pR/m8q/e9ra+r9kv5/kjyZQz9+X7nzl15gcv4U5o1e04a/cqruj2h+Z49e9I99z+YvvODH6X/OuWnadw773aYVxiX706YmE4765z8J6NP+fnp6dU33kyHDh0+oX43ahz/nxj2TFr72WeNVkkLFy1OL40a07A8giu37kt/f/u0NHvtrvZ6uw8cTt95uCWNbNnYXtabF2MXbEl/cMH49KXz3k1/eOH4dNqz89PGnQeyidc/2ZzLecbvG/fPSuta93cwv//QkXTuiEXp00172ss/WtGaLh31aaqglnaZ3r4As1vGregVtSeU5CHvf3jz3LRi1/ovBNMowTMgr7nhpjRx8pR0xaBrkggzKmRSZ0d8x933tu/2Dx8+nB589LH09HMvfGHXFOv25nUkefQy2B5/clh6+93x2UxJhkwaw559Po0Y+XJvutGprtKPTit0ItDb+jox1+nj403y9fTXco6FJjiRuO6rhWctf7pbPvSpYZ2eNixbviINvndIXsAyDkljXns9zZ33SaVZZJ58+tk+O9FiPI4cNTqT9o7W1nTrnXe1n2owZvH1N9fdkDZs3JjHMDLX3nhTmvrBh5X+d1a4ceOmPM7R3Uwp4s6iJi7KGvHz3UVb0388PDuRKz0/Y3369wdmpU/W7VZRr+bXvL4sTV7SdgJ18PDRdPeEVenaN5ZlG/EZUD86dW16aMqaDvbXtx7IC4Mdew+1lw/7aF3i19vp3omrU8uanZVqWQT11kLohJL8mDXvp+9MGJS++uoZHYi+UYIHncVLluSjxdadO9Pge+6rHGhMuhw/fvDRtPTAI48lOi8D6+4h96f33v+gfUJlN/HTM/4vH5Nf+Ztr0rp16/OR7r0PPJieeua59L0f/ThdcsVVafPmLXlwT35val7p//Anp6RHhz6Zbr79ziy/YuWqvEPnyJ3XAfMXLMwNWZI8hVOmvp8XG1wzyVMn/pg82PnEVB7dUg9SYFHw3PAR2c+4A9m/f3+eJPGf+IgTHfhLbDfddkeHo2v0sWAiVnYzz/9uRMaMBdVd992f8ZEeJiZ2OthDP/bLHQ36fn3NdXmhhb74CgJswIhydk/YoD47I3TGONDz8GNDs1/Yev3NsR12WGDEq40rr742Y4he2gIfZ85qybFT75HHn8gkAwa7du/O/QD7F1x6ebpnyAO5HWr5UEte7UNfO/OcX2X79DlsVPUryZPTdmpzteUtdwzOO0X6FqQT25wYwZDXOYox6sMH2o84iZcd57z5C77Q5sSi/oIcREpf0XghZwwwFsp2izGpPenfxHHyqT+rS/T0ecbO8BdfSrxqYzyyOGBMSi/26He7d+/JYxe96Fd67Y2x7Ysi+sG06TO+UBe9cQeKrqeeeTZt2rw5kzKvyz6cNj33J7BkDMe+S7+hPpuIXbvaxiCbCPCA4GMCS/Bid8yJ4aVXDUpLlixL1990S8aOMUbfZu7QuGKB/+mSpRkv4pvx8ayMi/r99HDSga3Y7lddc122p7LzLr4s0VfoP/ituQldpR4WUyxUquoqJvob/Ve4P/rEk+m3t96evnvSyXljArb0KfpWrbEIid08bkV6eXYbVmu378874stGL0nb9xxKT374WfrylZPTn10+KZMoxHvByMXpWw+1pD++eEK6fPSSdOjI0bxI+Itrp2bZHw2dm0mcHThy7NpZNGzYeSBxSnDm8wvyCYLi4DSBso27DqRfDF/YvnPfd/BIuvClxWnU7LZTVMmza8cHrbfIrxizJM1Y1Zr94XTgH++cntZs359PCH7w2Jz0RxdNSD9+cl5q3XconwD8270z07/eOzONnb8l/fUN7+cThQenrGnXia1zfrcwnyZwqjFqzqYcG1i8OX9LduWqV5am7z4yO+OA/8TW3XRCSV5Onzzlxnai7wrBU5+jbCYDEpMhu3U6YEyatBiAd95zX97tj337ncSPCYdJlsF78eVXpcWfcixzNE19/4O8gt+5a1e67qZb8v2RI0fykRUTDPJMbitXtZHIm+PeTlff8Nu0ddu29gUFehYt/jQxICHqRkg+TmRMOOwoWIzEmOKET5wiBiZkyJSdEgOYemvWfpbj1M6ECQ4CYXLFX/zGz5jQ98sLLsoTmSZEMFy1enUa9+74LD9n3ieZRJj8mAT5HoJJlEXUJwsWRHXZP/R9tm5dnkRfHvNKJlOwYqFBu+ADvrz48qisCz0Qzt69e/PijcUcfhEfE+r6DRvSjbfc1uH1C0bxa9qMmVnf+ImTarYtky84ckrCic6BAwcSOzJiwQ7xVPlQSz4GDFa0I/pr9auDBw/GKtlP7JLoj5lYdu9OS5Yuze/it+/Y0f5OfsKkyem+Bx5KlDHR4v/+A21HktTHPnjTh+mzEBU7Twgmtjk7TxaR4En8Qx56JI8hjRd8Z8fNX6CkfdjJYWv9+g0dxgrjjgUCMo3s5Fkw00chGwiasQHB0icZa/QT/Hno0cfz+OK7lfIoH6ywi48Q97p1Gyrrxh0oNllYoI/vG4ibscw8cOjQofTK629kIlbDDB8xMutkXCmxCGEzEcejnpGz2AAj+i2ncC1z5uQ2eOb54XkRQt+fM3debi/kwBofaCP8I2bqMiZY9DIGSNijfdSmnFy+PvatjCHjgFgYd8K2lh50UY84wL+sm419/h/hTvvQf/CRzRTzyvKVK3Mf3LJ1ax43zLvxVSjH3pDj2wu3pqc+WpcJjl31mDmbEjvq6Stb00+enJc27zqYtuw+mE5/bkH6dOOe9O2HWvKzrXsOZnJuWbMrff+xOWnF1n1Z9uQn5qalm/emX45YlBcPh48cTcNnbkiPTF2byR0i3xMIkRMDyjh+/6vr328/rv/TSycmFiHUj2noB5912N2zo4eQ31++I/uDbogY/69+bVkav3hb1nHdG8vyYoRXAuePXJxYRLBIGbdwa9q251A+NQATJRYpv351adq8+2C66OXFecEwf/3uXIbNkx6fm1hwHDjcthjR6YTqdyVvCpLHYYieD+waeQevAPXhHKtN/f7ntDO/8K5JkxY5kzQDnwHEpMKEyo8BxsBnYiZplQuZMGFTl8TkInkmNCXkmBDJ40dLe/ftyztl9Jckz6RY77ge3aVflNUiefR93NKSFzpnnH1uHowQAXaFDzmrceKo9SEXz6gjW4qfyefZF4bnnSo7LeKkDCJiAvrFr87PJBInRXREfdwrJsiDXV/0jR3PS6PHdCjjORO6sC/94l6JSYcJTicy+C57alvaknLuydGrRNvKTvRLPtSSV33yqL+0rX6l/qR6sss91/yirkjyYP7G2HF5tw7m5ftgdMc+qP6yYNHiDm0e7WALgiI+1ecURKcSwoId49x58zuMlezo5//pjOQZD5zGQBzsbFmkQ3ovjHgx4w4JKkHI4Efb41tMENBbb7+TcVi+YmVlXWT4pgXCJEGQLFQi8eMHZM6ij29kGEMkMOOUi/aKCaK7bfDdeRESy2e1zM525DNzE20j3MinTZ+ZfQBjTptYbLNI5sQFO5B9lKcNY59lzgI/khZIELaO0SFu7uvpIT69j6+qG2MS7mxkWEhRl9MWxhc2Of2Qv/ST2KchsYtf/jQt3rgn3fTWivxefsik1Zkgn5m2Pt03aXWCEEmQH++8IbJBry7NC4JNuw7knfYrczflI3fkID+eL9+yN531wsK0a3/bZo56D7+3NpMsJwcxYYcfrwwgdaXtew/lRUZ8bbBq2770Nzd/1H7cjyw7eBYUew8eyYsKThKwsWprm6ze75O/tWBLfo+ubxBYmHBqwS5/2spWmc45PoMHi5nB41elU4d9kr4+eHperLAgYSGkvRd+x1ceHRQ1cNM0JI+vp39wZ6cf2cWY6GgMFiYLEqt/doZ0zpg0aZFD7Hykx4BhdayJrtxxvTN+Ql6xs5PXxIdOEQDy7IriLrRqJ89KnlUwgzkSBAOGHSdHhuiSbmSUkGEHQ0xx50c5A41dKzGziyIOTiEgSVb17Oyox8BnItVOHoJgcON3V0kePXx8g352uhzfsbtnN8DiBr+YQJhkYgKzqp386tVr8tGnMIT0OVmh/dipsoshPiZl7Ah7dIug48QCRuwo2OXQJ2hD8Czblsm+s518LR8a3clrQi5tq1/F9iQe2k9Epj5JOfERQyT53418KfcL8F4Fhldf22EXRR3w5vUUMvQL7eRjm8edPP2CVzGcflAfglm9Zm0+hdJOnlMhiJVFXNWpFzGxaIVcayXaml27dsLgTJsRO8TFAoBdNf2L8UTcLCzZ3ccE8dD/8IcYq+qCPeMEHSz+GA9r1q7NO2zIijjxhbGCXyzSRaqconGUXrYTpz0cxdMnkeHH0TgnTBzhM0Y40UI3fYCxQh9Ghhjp15yuEB9xbdu2LY9f7HCqQd8kHhYujG8lFiO0HSdrxMKJR8ucue2vOZBj3LEIqacH3x5+fGhqbd1ZWVf28EG4Myb5kbS4YCwyFyCHT7z24FoJErvt7ZX5GB2iY9fLcT2Ez3to3nFrJ/3cjPXpf5+dn16YsaH9PTQyIjd2ybxff3HWxkx+EOMpT81Lq7ftS5/t2J93+pOWbMvkKzJEHr0cm7PgwBd8UlqyaW/+XoBciffx33xgVj4RoIxTBuxwpI//C9bvzjv0s4cvzDt4FhosFti14xtH+Fe+siQvRiD6W99ekY4cPZrwjQVPTJw8cDqAPKcb+HvDm8uzjyx+WFigl0UIryVYgHQ3NRXJdyUIJgnen3J8HBODh8HMwFLSpEVOOZODPpKJEyqEqB0g792YzEoyiUQjed6FserHLvL13slr5ctOGBsMZiV067nyqneuyDNhYPfs8y5IedIv3snznowJDqJkkuOIEZt6x82kHid8+UCOH1psxPiZdMAHuyNeGtX2hfTHs9rfyaMfbLEXE/qq3skzKUBEwlzvdvGZhQsx8NN7/oh99CvagkSJ8Sc/Oy298trr+Z01u0EmIeygL76Tz99y3DskYxPfydfyoZZ89IEF3YWXXpGJEj/VT9j5qF9Fea4hV54rRvoliT5bkrxOA5Dny24IJE6w1OGdPOODNiFufMCX2OYQVGfv5PXNBP0x9sUYE4QPSZI4ouZ0hlMDFgrEExP14tE7i27+5Qukzdikz+KzbEF+fPjGLxIuMTLeIF1SVV3mCBYd6GORwyIGQoLYwYLnvOrjefnuGj/pg1WJeYG+Sj36E4sD+jwYcHJAW/CDbHmuMQc50y+457SKMcHrvNPOOju3v97X064aC9E+3w9RV/ogahZF7O7BRicC9fTgIwvxWnVlL+L+/PAR+USFZyxyIXoW0Wwo8FVtpbrkfNAGWfEumY/vIEF23hx9s0vniJ5dMe+zITGIWAsA6rMIoD7vuZHjXTjv5SkjvdSysf09Nu/2d+8/nL73yOz243jkeR3AQoAj9viMXTe6INewLsl6OSLnnToyvCPnXToEDFF/ZdCU7AfH8AcOHc2nB39yycQshw+cWmgHru8D+GaA9/La3WcjKeVFwz8NnpHj4JuEf7lnZrpx7PJ8esFX9fyrAMXMwgW/WAjFI3/p6izvtyTfWWB9/bw8lu1r+7ZnBIQABBiP61XeaN7T+o3a6a4cBMr7cxaITgMXAcgZQuXjOXbMLBB6sqMduEjVj8wkXx+fmk9ZyXJMzUqcSYfdSa1/p19TiR8YgeOAQE9JWicF6Gm2xLE1r7jYjXMS4TSwEeAjN32B/8SHfKA7sOM9HtGZ5HuAqv4JSa3jtR6odlUjcEIQ4BibU4Db77qnwyuvE+KMjRoBI9BjBEzyPYbQCoyAETACRsAINCcCJvnmbBd7ZQSMgBEwAkagxwiY5HsMoRUYASNgBIyAEWhOBEzyzdku9soIGAEjYASMQI8RMMn3GEIrMAJGwAgYASPQnAiY5JuzXeyVETACRsAIGIEeI2CS7zGEVmAEjIARMAJGoDkRMMk3Z7vYKyNgBIyAETACPUbAJN9jCK3ACBgBI2AEjEBzItC3JP/h91J652sptc5rQ2PdqJTG/WVKlHc1zTkvJf3QuXlSSpP/uXu6umpb8vj/zldTIj8RadmQlN78Slvc+z//m9fCFCxU1he+yRf80Y/2Uap6HvuC5I5nDjZTv9G3uCge+nh3+rnqdyWn3ftyLNC2fd2WXcHDskbg9xiBviV5EZAm/5L0u9IQTCz80PX7TvIslLTQAI+S+LuCa3dlaYvoh9paxFY+Z6FHu6kvdNduV+phc9YZXanRe7I9IXmw1GJSBF4PN8kI+86iUFvQRo2mGA/1moHkFXc9bMr4msX30i/fG4FeQqBvSR6nGYBMCJr0NbEwaWgHqMmpnHzigOSan/TV2slr4E/422P6NQnoWWkXP9Gt8khe8qnqmRol+il5ynStupTJVpwkNYFG/6IP0Q7lEAC6JE/9uJOvwlayneGCX3FXKPImhugT9uM9PqptiLt8LiyEgWKSX2qjKoITfuon1I0xKnbZQJ441o1uI3nZqNIjP+R/KYO/sSziQXmMhxgkSy5/a9XJeH21DUfkiWPVU8fuKVt8S1u58Ik2hL/ik70oE/uZYhVO+M5PfQp7VfIl1vgU68gP9NeKVbbJ69nkGX7wi3rxAd82T27DY9LXU+InWcUuO8IkPq/SXVVW1kWH8Jd+50agSRHoe5LXhMJA0WTMgNFkoueU6ZqBRyKXnABV3c5IvsoWdVUebcVr7EiudW6bvCYQyuPEI59ifZEUkzW2VJdYVLeMCxl+mlzko/QrV73p/90mj90Jf5fSx6cfi0v48Ex+UVbqjnLYlk3VoUzXyJJinRhP9C/GqAlWOTrLJL9kQ/iRR3v4QqyUCwfKYn35W9qppSf6EnVKD2X88J882qJurMO1Yld9/KhXB79Uh7i4Rk/EINaXXmRI6I82uI56JCNs22oda1f08FN80l/KSw/6SbFOfBZ9lVw5flVeZVP2FR9+lP2SesKstIduJerKNnqr+k4texr3sh3bQ/qdG4EmRaDvSR4gGHAa1BqYmjD0nAG1eWLbwNQgJ9dAFaAavJ2RPHIk6ZA8fsQffiATy7hmIpk/6NjEi65ag10xYZMfsWhHpliijHxikiHhA78o0/ak439Vb/6v22wsurljrsmpCls9q4WLyqM/2NOESnmcFMtnPI9l8Zpnii36FstlP2KMDtqirMN92V5V/Qf9pFp6Pn+cM3SWdlRXfVAEWtpGP3VFCtSTvnp11FfAJmIbMRBuwkdy8gE7kuFaz+VzjFHXksFvfpKVHtmSfIyH61iHe+SxXS/WqCvWjzYpV1zKY//Tc/kX60b98hEd+BVTtC19skWOPS3QG7ETdfvaCDQBAieG5BlMGqwamHHwMZiqJuk4IAUeskxKIu2oBxnp1wCNOpAt5akTJ1XZUTl+o0P3elfaVnLsv4qBD7241oSnutGv6BMa5FeUOab52JXqrRvTtjPBFnVlW0QeYyyfcU+SLiZ85EVQIgDKkFG7UUfPKC+f8Rzdkq/1XISSnahor7It0KlJWLoVE3jFFP2L5VxX6YkyxBtx0zPikM/19EcMqSt99erEOKJcxCD2CfUptZVsSEb+S064YSemaCvGJz2lfIyH61iHe+SxHfVGe+V1rB9txrjLOtxjg5gUf6xbJY9fwkB9J9quZa/UW95X2XKZEWgSBE48yQMEg08TZxxAmiQ0yTCoJScAVbc7JM8A12CXXcp0rUmSMiaSkjSxrfryR7kmjKr35cjoOXn0QzFjW34ofulWrnqrhrX5xwRGGfKa+IQPeqO+eI0+6glb+aAJkRx/VC5/Yh35QjwkyUYMI1ayLz/bah3zUfWwpXro5LSChB3KsRuveUZd6skHZGKqpSfKRNykh7IYM/LYUgz4wTEw8hEP1VdMteqgX7pUR/FpMSnc5IuwUTm64zU+ctJDWVmueKOtGJ/ksVUm7CieWAc55PWMXDFFfKK+WD/a1LV0IRd1ETuvptQPJF/lLzFW9Z0q26U9jfvSNnWdjECTI9AcJA9IDCyRigYZ5QxYlZOLiAQszynrDsmX+tEDYZI08ck2772ZREQoKtck21br2H814UR/S52aJCQrneRgoPKqSQtL1Jd94YANrjUhIVeFbak7TnbHomi7or7aJMYv2/Il+q8YpAv95fNYX3JVuiQX46inH3kmdOEtnGWjnh7JkEc5xV/iJBwVG6cp2C3rR39r1YntFn2P8vHDu1gu++Szzmxrf3wucY/9sc3LjjjF+KS/qv9JL/0Mn6Je5IWXdMi/iI/s17MpHFSfcViSLvbUR8qcyIEAAAHDSURBVLhGVvZlg3vpiM+lX/V1L9loT2XkwoTxoAWYbDk3Ak2EwIkh+SYC4Li6wsRSTjbH1WAvKWcC06StSU+TWi+ZsBoj0G8Q0ELFY6DfNJkdPYaASf4YFr13pUlBu4Pe09w3muS/di7xVKBvPLAVI9A8CGg8mOSbp03sScMImOQbhsqCRsAIGAEjYAT6FwIm+f7VXvbWCBgBI2AEjEDDCJjkG4bKgkbACBgBI2AE+hcCJvn+1V721ggYASNgBIxAwwiY5BuGyoJGwAgYASNgBPoXAib5/tVe9tYIGAEjYASMQMMImOQbhsqCRsAIGAEjYAT6FwIm+f7VXvbWCBgBI2AEjEDDCJjkG4bKgkbACBgBI2AE+hcCJvn+1V721ggYASNgBIxAwwiY5BuGyoJGwAgYASNgBPoXAib5/tVe9tYIGAEjYASMQMMImOQbhsqCRsAIGAEjYAT6FwIm+f7VXvbWCBgBI2AEjEDDCJjkG4bKgkbACBgBI2AE+hcCJvn+1V721ggYASNgBIxAwwiY5BuGyoJGwAgYASNgBPoXAib5/tVe9tYIGAEjYASMQMMImOQbhsqCRsAIGAEjYAT6FwL/D1eKRkIkJrElAAAAAElFTkSuQmCC"></p><p>Also get the connection string that we will use in our python notebook code to connnect:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-18.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-18-ec3703a24ca18f475f4f78de6513a9c0.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-a-database">Create a database<a class="hash-link" href="#create-a-database" title="Direct link to heading">â€‹</a></h3><p>Click on <em>COLLECTIONS</em>, the third button on center-left of this image:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-19.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-19-7aea8a48c24f9de8272874db0bc4737a.png"></p><p>Click on <em>Add My Own Data</em> and Create the <em>Database</em>:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-20.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-20-bbd2adce5ab6c9c486423725ead6f86b.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="kafka-producer">Kafka producer<a class="hash-link" href="#kafka-producer" title="Direct link to heading">â€‹</a></h2><p>Open <a href="https://github.com/RecoHut-Stanzas/S307784/blob/main/nbs/Kafka%20Producer.ipynb" target="_blank" rel="noopener noreferrer">this</a> jupyter notebook in any of your favorite editor. I used Google Colab. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configure-kafka-credentials">Configure Kafka credentials<a class="hash-link" href="#configure-kafka-credentials" title="Direct link to heading">â€‹</a></h3><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-21.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-21-bb7f01501d61ec3b95eb0eabb577e7a2.png"></p><p>We need to get these 4 parameters from CloudKerafka account that we created. </p><p>Once configured, we are ready to stream events to the topic server. There are 2 ways to run the stream: We can either send a fixed number of events or run a script endlessly that will ask for the message to be sent via terminal. </p><p>In practical scenarios, we inject a javascript into the user&#x27;s browser session that sends the event to a listening server and that server sends those messages to the kafka producer.</p><p>We sent 5 messages to the topic server which would look like this:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-22.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-22-e32042745fc68a3a8eb1f428a920fd96.png"></p><p>The cloudkarafka manager dashboard would look like this:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-23.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-23-2e39eb18637e12a194127cbb5f9d149a.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="end-to-end-producer-script">End-to-end producer script<a class="hash-link" href="#end-to-end-producer-script" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-python theme-code-block"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">writefile producer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> confluent_kafka </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Producer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_TOPIC </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;yx03wajr-demo&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_BROKERS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> &#x27;dory</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01.</span><span class="token plain">srvs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cloudkafka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9094</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dory</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02.</span><span class="token plain">srvs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cloudkafka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9094</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dory</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03.</span><span class="token plain">srvs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cloudkafka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9094</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_USERNAME </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;yx03wajr&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_PASSWORD </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pHva0afDUXPya6JfKrbM1******&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    topic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CLOUDKARAFKA_TOPIC</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Consumer configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># See https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;bootstrap.servers&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CLOUDKARAFKA_BROKERS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;session.timeout.ms&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;default.topic.config&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;auto.offset.reset&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;smallest&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;security.protocol&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SASL_SSL&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;sasl.mechanisms&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SCRAM-SHA-256&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;sasl.username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CLOUDKARAFKA_USERNAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;sasl.password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CLOUDKARAFKA_PASSWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Producer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">**</span><span class="token plain">conf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">delivery_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% Message failed delivery: %s\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% Message delivered to %s [%d]\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                             </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">topic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">partition</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> line </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stdin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">produce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">topic</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rstrip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> callback</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">delivery_callback</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> BufferError </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% Local producer queue is full (%d messages awaiting delivery): try again\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                             </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">poll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% Waiting for %d deliveries\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="kafka-consumer-and-mongodb">Kafka consumer and mongodb<a class="hash-link" href="#kafka-consumer-and-mongodb" title="Direct link to heading">â€‹</a></h2><p>Open <a href="https://github.com/RecoHut-Stanzas/S307784/blob/main/nbs/Kafka%20Consumer.ipynb" target="_blank" rel="noopener noreferrer">this</a> jupyter notebook in any of your favorite editor. I used Google Colab. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configure-kafka-credentials-1">Configure Kafka credentials<a class="hash-link" href="#configure-kafka-credentials-1" title="Direct link to heading">â€‹</a></h3><p>Configuration process is same as previous step.</p><p>Once configured, the received messages would look like this:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-24.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-24-880b4d5f1d6b684132b5f629bd544f55.png"></p><p>We are able to successfully receive the messages in real-time.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configure-mongodb">Configure MongoDB<a class="hash-link" href="#configure-mongodb" title="Direct link to heading">â€‹</a></h3><p>Now, let&#x27;s store these messages in a persistent database. We are using MongoDB for that.</p><p>Enter these 4 parameters that we received during mongoDB configuration:</p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-25.png" src="data:image/png;base64,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"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="end-to-end-consumer--mongodb-script">End-to-end consumer + mongodb script<a class="hash-link" href="#end-to-end-consumer--mongodb-script" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-python theme-code-block"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">writefile consumer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> confluent_kafka </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Consumer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> KafkaException</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> KafkaError</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pymongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_TOPIC </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;yx03wajr-demo&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_BROKERS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> &#x27;dory</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01.</span><span class="token plain">srvs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cloudkafka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9094</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dory</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02.</span><span class="token plain">srvs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cloudkafka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9094</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dory</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03.</span><span class="token plain">srvs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cloudkafka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9094</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_USERNAME </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;yx03wajr&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLOUDKARAFKA_PASSWORD </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pHva0afDUXPya6JfKrbM1j549G*****&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MONGODB_USER </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;kafka-demo&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MONGODB_PASSWORD </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;your-pass&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MONGODB_CLUSTER </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cluster0.ca4wh.mongodb.net&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MONGODB_DATABASE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;movielens&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mongo_uri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;mongodb+srv://</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">MONGODB_USER</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">:</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">MONGODB_PASSWORD</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">@</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">MONGODB_CLUSTER</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">MONGODB_DATABASE</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">?retryWrites=true&amp;w=majority&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pymongo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MongoClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mongo_uri</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mydb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MONGODB_DATABASE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">movies </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mydb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    topics </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CLOUDKARAFKA_TOPIC</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Consumer configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># See https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    conf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;bootstrap.servers&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CLOUDKARAFKA_BROKERS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;group.id&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s-consumer&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> CLOUDKARAFKA_USERNAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;session.timeout.ms&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;default.topic.config&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;auto.offset.reset&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;smallest&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;security.protocol&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SASL_SSL&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;sasl.mechanisms&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SCRAM-SHA-256&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;sasl.username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CLOUDKARAFKA_USERNAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;sasl.password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CLOUDKARAFKA_PASSWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Consumer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">**</span><span class="token plain">conf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">topics</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            msg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">poll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> msg </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Error or event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> KafkaError</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_PARTITION_EOF</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># End of partition event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% %s [%d] reached end at offset %d\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">topic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">partition</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> KafkaException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Proper message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% %s [%d] at offset %d with key %s:\n&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">topic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">partition</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  movies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">eval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  movies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;err_flag&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;msg&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> KeyboardInterrupt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stderr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;%% Aborted by user\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Close down consumer to commit final offsets.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="mongodb-listener">MongoDB listener<a class="hash-link" href="#mongodb-listener" title="Direct link to heading">â€‹</a></h2><p>Open <a href="https://github.com/RecoHut-Stanzas/S307784/blob/main/nbs/MongoDB%20Listener.ipynb" target="_blank" rel="noopener noreferrer">this</a> jupyter notebook in any of your favorite editor. I used Google Colab. </p><p>On every message that we are receiving from Kafka, we are storing it in MongoDB. A more efficient process is to store in batch. Here is the side-by-side notebook snapshot of the entire process. Left is the producer who is sending the JSON to Kafka broker, the center is the consumer who is subscribed to the topic and receiving the messages in real-time. And on the right side, we have a MongoDB listener which is connected to MongoDB, listening to the events and converting them into a pandas data frame. </p><p><img alt="/img/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-26.png" src="/assets/images/content-tutorials-raw-real-time-event-capturing-with-kafka-and-mongodb-untitled-26-5c4d13a49731cb6e3cf0f67e3c78a9ff.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p>Congratulations! You have successfully completed the first step in building a real-time recommendation system. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="whatwevecovered">WhatÂ we&#x27;veÂ covered<a class="hash-link" href="#whatwevecovered" title="Direct link to heading">â€‹</a></h3><ul><li>Loaded and preprocessed movielens dataset</li><li>Trained and compared 4 versions of neural net models using tensorflow keras</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="nextsteps">NextÂ steps<a class="hash-link" href="#nextsteps" title="Direct link to heading">â€‹</a></h3><ul><li>Build a recommender model on the data that we received from mongodb stream</li><li>We can create a batch of let&#x27;s say 10 records to update the model parameters or keep updating these parameters on every single record</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">â€‹</a></h2><ol><li><a href="https://github.com/RecoHut-Stanzas/S307784" target="_blank" rel="noopener noreferrer">https://github.com/RecoHut-Stanzas/S307784</a></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/recohut/docs/docs/docs/tutorials/real-time-event-capturing-with-kafka-and-mongodb.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tutorials/matching-and-ranking-models-in-tensorflow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Matching and Ranking models in Tensorflow</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tutorials/session-based-recommendation-with-graph-neural-net"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Session-based Recommendation with Graph Neural Networks</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#whyisthisimportant" class="table-of-contents__link toc-highlight">WhyÂ isÂ thisÂ important?</a></li><li><a href="#howitwillwork" class="table-of-contents__link toc-highlight">HowÂ itÂ willÂ work?</a></li><li><a href="#setup-kafka" class="table-of-contents__link toc-highlight">Setup Kafka</a><ul><li><a href="#sign-up" class="table-of-contents__link toc-highlight">Sign-up</a></li><li><a href="#create-a-team" class="table-of-contents__link toc-highlight">Create a team</a></li><li><a href="#create-an-instance" class="table-of-contents__link toc-highlight">Create an instance</a></li><li><a href="#create-kafka-topic" class="table-of-contents__link toc-highlight">Create Kafka topic</a></li></ul></li><li><a href="#setup-mongodb" class="table-of-contents__link toc-highlight">Setup MongoDB</a><ul><li><a href="#sign-up-1" class="table-of-contents__link toc-highlight">Sign up</a></li><li><a href="#create-organization" class="table-of-contents__link toc-highlight">Create organization</a></li><li><a href="#create-a-project" class="table-of-contents__link toc-highlight">Create a project</a></li><li><a href="#create-a-cluster" class="table-of-contents__link toc-highlight">Create a cluster</a></li><li><a href="#configure-user" class="table-of-contents__link toc-highlight">Configure user</a></li><li><a href="#create-a-database" class="table-of-contents__link toc-highlight">Create a database</a></li></ul></li><li><a href="#kafka-producer" class="table-of-contents__link toc-highlight">Kafka producer</a><ul><li><a href="#configure-kafka-credentials" class="table-of-contents__link toc-highlight">Configure Kafka credentials</a></li><li><a href="#end-to-end-producer-script" class="table-of-contents__link toc-highlight">End-to-end producer script</a></li></ul></li><li><a href="#kafka-consumer-and-mongodb" class="table-of-contents__link toc-highlight">Kafka consumer and mongodb</a><ul><li><a href="#configure-kafka-credentials-1" class="table-of-contents__link toc-highlight">Configure Kafka credentials</a></li><li><a href="#configure-mongodb" class="table-of-contents__link toc-highlight">Configure MongoDB</a></li><li><a href="#end-to-end-consumer--mongodb-script" class="table-of-contents__link toc-highlight">End-to-end consumer + mongodb script</a></li></ul></li><li><a href="#mongodb-listener" class="table-of-contents__link toc-highlight">MongoDB listener</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a><ul><li><a href="#whatwevecovered" class="table-of-contents__link toc-highlight">WhatÂ we&#39;veÂ covered</a></li><li><a href="#nextsteps" class="table-of-contents__link toc-highlight">NextÂ steps</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/recohut/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Recohut Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1c09e74f.js"></script>
<script src="/assets/js/main.0b9e1a49.js"></script>
</body>
</html>