# AUTOGENERATED! DO NOT EDIT! File to edit: nbs/datasets/datasets.amazon_beauty.ipynb (unless otherwise specified).

__all__ = ['AmazonBeautyDataset', 'AmazonBeautyDataModule']

# Cell
from typing import Any, Iterable, List, Optional, Tuple, Union, Callable

import os
import pandas as pd

from ..utils.common_utils import *

from .bases.sequential import SASRecDataset, SASRecDataModule

# Cell
class AmazonBeautyDataset(SASRecDataset):

    url = 'https://github.com/RecoHut-Datasets/amazon_beauty/raw/v1/amazon-ratings.zip'

    @property
    def raw_file_names(self):
        return 'ratings_Beauty.csv'

    def download(self):
        path = download_url(self.url, self.raw_dir)
        extract_zip(path, self.raw_dir)
        os.unlink(path)

    def load_ratings_df(self):
        df = pd.read_csv(self.raw_paths[0])
        df.columns = ['uid', 'sid', 'rating', 'timestamp']
        # drop duplicate user-item pair records, keeping latest rating only
        df.drop_duplicates(subset=['uid', 'sid'], keep='last', inplace=True)
        return df

# Cell
class AmazonBeautyDataModule(SASRecDataModule):

    dataset_cls = AmazonBeautyDataset